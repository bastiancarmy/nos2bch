var Ei=Object.create;var Qr=Object.defineProperty;var Bi=Object.getOwnPropertyDescriptor;var Si=Object.getOwnPropertyNames;var Li=Object.getPrototypeOf,Ui=Object.prototype.hasOwnProperty;var Ee=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Ti=(e,t)=>{for(var r in t)Qr(e,r,{get:t[r],enumerable:!0})},Ii=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of Si(t))!Ui.call(e,o)&&o!==r&&Qr(e,o,{get:()=>t[o],enumerable:!(n=Bi(t,o))||n.enumerable});return e};var tn=(e,t,r)=>(r=e!=null?Ei(Li(e)):{},Ii(t||!e||!e.__esModule?Qr(r,"default",{value:e,enumerable:!0}):r,e));var rn=Ee((en,go)=>{(function(e,t){if(typeof define=="function"&&define.amd)define("webextension-polyfill",["module"],t);else if(typeof en<"u")t(go);else{var r={exports:{}};t(r),e.browser=r.exports}})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:en,function(e){"use strict";if(!(globalThis.chrome&&globalThis.chrome.runtime&&globalThis.chrome.runtime.id))throw new Error("This script should only be loaded in a browser extension.");if(globalThis.browser&&globalThis.browser.runtime&&globalThis.browser.runtime.id)e.exports=globalThis.browser;else{let t="The message port closed before a response was received.",r=n=>{let o={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(o).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class c extends WeakMap{constructor(L,U=void 0){super(U),this.createItem=L}get(L){return this.has(L)||this.set(L,this.createItem(L)),super.get(L)}}let i=B=>B&&typeof B=="object"&&typeof B.then=="function",s=(B,L)=>(...U)=>{n.runtime.lastError?B.reject(new Error(n.runtime.lastError.message)):L.singleCallbackArg||U.length<=1&&L.singleCallbackArg!==!1?B.resolve(U[0]):B.resolve(U)},a=B=>B==1?"argument":"arguments",u=(B,L)=>function(H,...P){if(P.length<L.minArgs)throw new Error(`Expected at least ${L.minArgs} ${a(L.minArgs)} for ${B}(), got ${P.length}`);if(P.length>L.maxArgs)throw new Error(`Expected at most ${L.maxArgs} ${a(L.maxArgs)} for ${B}(), got ${P.length}`);return new Promise((z,M)=>{if(L.fallbackToNoCallback)try{H[B](...P,s({resolve:z,reject:M},L))}catch(N){console.warn(`${B} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,N),H[B](...P),L.fallbackToNoCallback=!1,L.noCallback=!0,z()}else L.noCallback?(H[B](...P),z()):H[B](...P,s({resolve:z,reject:M},L))})},l=(B,L,U)=>new Proxy(L,{apply(H,P,z){return U.call(P,B,...z)}}),h=Function.call.bind(Object.prototype.hasOwnProperty),y=(B,L={},U={})=>{let H=Object.create(null),P={has(M,N){return N in B||N in H},get(M,N,j){if(N in H)return H[N];if(!(N in B))return;let D=B[N];if(typeof D=="function")if(typeof L[N]=="function")D=l(B,B[N],L[N]);else if(h(U,N)){let G=u(N,U[N]);D=l(B,B[N],G)}else D=D.bind(B);else if(typeof D=="object"&&D!==null&&(h(L,N)||h(U,N)))D=y(D,L[N],U[N]);else if(h(U,"*"))D=y(D,L[N],U["*"]);else return Object.defineProperty(H,N,{configurable:!0,enumerable:!0,get(){return B[N]},set(G){B[N]=G}}),D;return H[N]=D,D},set(M,N,j,D){return N in H?H[N]=j:B[N]=j,!0},defineProperty(M,N,j){return Reflect.defineProperty(H,N,j)},deleteProperty(M,N){return Reflect.deleteProperty(H,N)}},z=Object.create(B);return new Proxy(z,P)},w=B=>({addListener(L,U,...H){L.addListener(B.get(U),...H)},hasListener(L,U){return L.hasListener(B.get(U))},removeListener(L,U){L.removeListener(B.get(U))}}),x=new c(B=>typeof B!="function"?B:function(U){let H=y(U,{},{getContent:{minArgs:0,maxArgs:0}});B(H)}),p=new c(B=>typeof B!="function"?B:function(U,H,P){let z=!1,M,N=new Promise(T=>{M=function(I){z=!0,T(I)}}),j;try{j=B(U,H,M)}catch(T){j=Promise.reject(T)}let D=j!==!0&&i(j);if(j!==!0&&!D&&!z)return!1;let G=T=>{T.then(I=>{P(I)},I=>{let R;I&&(I instanceof Error||typeof I.message=="string")?R=I.message:R="An unexpected error occurred",P({__mozWebExtensionPolyfillReject__:!0,message:R})}).catch(I=>{console.error("Failed to send onMessage rejected reply",I)})};return G(D?j:N),!0}),g=({reject:B,resolve:L},U)=>{n.runtime.lastError?n.runtime.lastError.message===t?L():B(new Error(n.runtime.lastError.message)):U&&U.__mozWebExtensionPolyfillReject__?B(new Error(U.message)):L(U)},v=(B,L,U,...H)=>{if(H.length<L.minArgs)throw new Error(`Expected at least ${L.minArgs} ${a(L.minArgs)} for ${B}(), got ${H.length}`);if(H.length>L.maxArgs)throw new Error(`Expected at most ${L.maxArgs} ${a(L.maxArgs)} for ${B}(), got ${H.length}`);return new Promise((P,z)=>{let M=g.bind(null,{resolve:P,reject:z});H.push(M),U.sendMessage(...H)})},E={devtools:{network:{onRequestFinished:w(x)}},runtime:{onMessage:w(p),onMessageExternal:w(p),sendMessage:v.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:v.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},k={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return o.privacy={network:{"*":k},services:{"*":k},websites:{"*":k}},y(n,E,o)};e.exports=r(chrome)}})});var Kr=Ee((Zl,ni)=>{"use strict";function uo(e){var t=new Error;this.name=t.name="ValidationError",this.message=t.message=e,this.stack=t.stack}uo.prototype=Object.create(Error.prototype);function za(e,t){if(!e)throw new uo(t)}ni.exports={ValidationError:uo,validate:za}});var ii=Ee((Wl,si)=>{"use strict";var jr=Kr().validate,Ka="qpzry9x8gf2tvdw0s3jn54khce6mua7l",oi={q:0,p:1,z:2,r:3,y:4,9:5,x:6,8:7,g:8,f:9,2:10,t:11,v:12,d:13,w:14,0:15,s:16,3:17,j:18,n:19,5:20,4:21,k:22,h:23,c:24,e:25,6:26,m:27,u:28,a:29,7:30,l:31};function ja(e){jr(e instanceof Uint8Array,"Invalid data: "+e+".");for(var t="",r=0;r<e.length;++r){var n=e[r];jr(0<=n&&n<32,"Invalid value: "+n+"."),t+=Ka[n]}return t}function Za(e){jr(typeof e=="string","Invalid base32-encoded string: "+e+".");for(var t=new Uint8Array(e.length),r=0;r<e.length;++r){var n=e[r];jr(n in oi,"Invalid value: "+n+"."),t[r]=oi[n]}return t}si.exports={encode:ja,decode:Za}});var ci=Ee((Gl,Zr)=>{var st=function(e){"use strict";var t=1e7,r=7,n=9007199254740992,o=l(n),c=Math.log(n);function i(f,d){return typeof f>"u"?i[0]:typeof d<"u"?+d==10?tt(f):Wt(f,d):tt(f)}function s(f,d){this.value=f,this.sign=d,this.isSmall=!1}s.prototype=Object.create(i.prototype);function a(f){this.value=f,this.sign=f<0,this.isSmall=!0}a.prototype=Object.create(i.prototype);function u(f){return-n<f&&f<n}function l(f){return f<1e7?[f]:f<1e14?[f%1e7,Math.floor(f/1e7)]:[f%1e7,Math.floor(f/1e7)%1e7,Math.floor(f/1e14)]}function h(f){y(f);var d=f.length;if(d<4&&I(f,o)<0)switch(d){case 0:return 0;case 1:return f[0];case 2:return f[0]+f[1]*t;default:return f[0]+(f[1]+f[2]*t)*t}return f}function y(f){for(var d=f.length;f[--d]===0;);f.length=d+1}function w(f){for(var d=new Array(f),m=-1;++m<f;)d[m]=0;return d}function x(f){return f>0?Math.floor(f):Math.ceil(f)}function p(f,d){var m=f.length,b=d.length,S=new Array(m),A=0,_=t,O,q;for(q=0;q<b;q++)O=f[q]+d[q]+A,A=O>=_?1:0,S[q]=O-A*_;for(;q<m;)O=f[q]+A,A=O===_?1:0,S[q++]=O-A*_;return A>0&&S.push(A),S}function g(f,d){return f.length>=d.length?p(f,d):p(d,f)}function v(f,d){var m=f.length,b=new Array(m),S=t,A,_;for(_=0;_<m;_++)A=f[_]-S+d,d=Math.floor(A/S),b[_]=A-d*S,d+=1;for(;d>0;)b[_++]=d%S,d=Math.floor(d/S);return b}s.prototype.add=function(f){var d=tt(f);if(this.sign!==d.sign)return this.subtract(d.negate());var m=this.value,b=d.value;return d.isSmall?new s(v(m,Math.abs(b)),this.sign):new s(g(m,b),this.sign)},s.prototype.plus=s.prototype.add,a.prototype.add=function(f){var d=tt(f),m=this.value;if(m<0!==d.sign)return this.subtract(d.negate());var b=d.value;if(d.isSmall){if(u(m+b))return new a(m+b);b=l(Math.abs(b))}return new s(v(b,Math.abs(m)),m<0)},a.prototype.plus=a.prototype.add;function E(f,d){var m=f.length,b=d.length,S=new Array(m),A=0,_=t,O,q;for(O=0;O<b;O++)q=f[O]-A-d[O],q<0?(q+=_,A=1):A=0,S[O]=q;for(O=b;O<m;O++){if(q=f[O]-A,q<0)q+=_;else{S[O++]=q;break}S[O]=q}for(;O<m;O++)S[O]=f[O];return y(S),S}function k(f,d,m){var b;return I(f,d)>=0?b=E(f,d):(b=E(d,f),m=!m),b=h(b),typeof b=="number"?(m&&(b=-b),new a(b)):new s(b,m)}function B(f,d,m){var b=f.length,S=new Array(b),A=-d,_=t,O,q;for(O=0;O<b;O++)q=f[O]+A,A=Math.floor(q/_),q%=_,S[O]=q<0?q+_:q;return S=h(S),typeof S=="number"?(m&&(S=-S),new a(S)):new s(S,m)}s.prototype.subtract=function(f){var d=tt(f);if(this.sign!==d.sign)return this.add(d.negate());var m=this.value,b=d.value;return d.isSmall?B(m,Math.abs(b),this.sign):k(m,b,this.sign)},s.prototype.minus=s.prototype.subtract,a.prototype.subtract=function(f){var d=tt(f),m=this.value;if(m<0!==d.sign)return this.add(d.negate());var b=d.value;return d.isSmall?new a(m-b):B(b,Math.abs(m),m>=0)},a.prototype.minus=a.prototype.subtract,s.prototype.negate=function(){return new s(this.value,!this.sign)},a.prototype.negate=function(){var f=this.sign,d=new a(-this.value);return d.sign=!f,d},s.prototype.abs=function(){return new s(this.value,!1)},a.prototype.abs=function(){return new a(Math.abs(this.value))};function L(f,d){var m=f.length,b=d.length,S=m+b,A=w(S),_=t,O,q,W,et,Q;for(W=0;W<m;++W){et=f[W];for(var rt=0;rt<b;++rt)Q=d[rt],O=et*Q+A[W+rt],q=Math.floor(O/_),A[W+rt]=O-q*_,A[W+rt+1]+=q}return y(A),A}function U(f,d){var m=f.length,b=new Array(m),S=t,A=0,_,O;for(O=0;O<m;O++)_=f[O]*d+A,A=Math.floor(_/S),b[O]=_-A*S;for(;A>0;)b[O++]=A%S,A=Math.floor(A/S);return b}function H(f,d){for(var m=[];d-- >0;)m.push(0);return m.concat(f)}function P(f,d){var m=Math.max(f.length,d.length);if(m<=30)return L(f,d);m=Math.ceil(m/2);var b=f.slice(m),S=f.slice(0,m),A=d.slice(m),_=d.slice(0,m),O=P(S,_),q=P(b,A),W=P(g(S,b),g(_,A)),et=g(g(O,H(E(E(W,O),q),m)),H(q,2*m));return y(et),et}function z(f,d){return-.012*f-.012*d+15e-6*f*d>0}s.prototype.multiply=function(f){var d=tt(f),m=this.value,b=d.value,S=this.sign!==d.sign,A;if(d.isSmall){if(b===0)return i[0];if(b===1)return this;if(b===-1)return this.negate();if(A=Math.abs(b),A<t)return new s(U(m,A),S);b=l(A)}return z(m.length,b.length)?new s(P(m,b),S):new s(L(m,b),S)},s.prototype.times=s.prototype.multiply;function M(f,d,m){return f<t?new s(U(d,f),m):new s(L(d,l(f)),m)}a.prototype._multiplyBySmall=function(f){return u(f.value*this.value)?new a(f.value*this.value):M(Math.abs(f.value),l(Math.abs(this.value)),this.sign!==f.sign)},s.prototype._multiplyBySmall=function(f){return f.value===0?i[0]:f.value===1?this:f.value===-1?this.negate():M(Math.abs(f.value),this.value,this.sign!==f.sign)},a.prototype.multiply=function(f){return tt(f)._multiplyBySmall(this)},a.prototype.times=a.prototype.multiply;function N(f){var d=f.length,m=w(d+d),b=t,S,A,_,O,q;for(_=0;_<d;_++){O=f[_],A=0-O*O;for(var W=_;W<d;W++)q=f[W],S=2*(O*q)+m[_+W]+A,A=Math.floor(S/b),m[_+W]=S-A*b;m[_+d]=A}return y(m),m}s.prototype.square=function(){return new s(N(this.value),!1)},a.prototype.square=function(){var f=this.value*this.value;return u(f)?new a(f):new s(N(l(Math.abs(this.value))),!1)};function j(f,d){var m=f.length,b=d.length,S=t,A=w(d.length),_=d[b-1],O=Math.ceil(S/(2*_)),q=U(f,O),W=U(d,O),et,Q,rt,vt,mt,Fr,Jr;for(q.length<=m&&q.push(0),W.push(0),_=W[b-1],Q=m-b;Q>=0;Q--){for(et=S-1,q[Q+b]!==_&&(et=Math.floor((q[Q+b]*S+q[Q+b-1])/_)),rt=0,vt=0,Fr=W.length,mt=0;mt<Fr;mt++)rt+=et*W[mt],Jr=Math.floor(rt/S),vt+=q[Q+mt]-(rt-Jr*S),rt=Jr,vt<0?(q[Q+mt]=vt+S,vt=-1):(q[Q+mt]=vt,vt=0);for(;vt!==0;){for(et-=1,rt=0,mt=0;mt<Fr;mt++)rt+=q[Q+mt]-S+W[mt],rt<0?(q[Q+mt]=rt+S,rt=0):(q[Q+mt]=rt,rt=1);vt+=rt}A[Q]=et}return q=G(q,O)[0],[h(A),h(q)]}function D(f,d){for(var m=f.length,b=d.length,S=[],A=[],_=t,O,q,W,et,Q;m;){if(A.unshift(f[--m]),y(A),I(A,d)<0){S.push(0);continue}q=A.length,W=A[q-1]*_+A[q-2],et=d[b-1]*_+d[b-2],q>b&&(W=(W+1)*_),O=Math.ceil(W/et);do{if(Q=U(d,O),I(Q,A)<=0)break;O--}while(O);S.push(O),A=E(A,Q)}return S.reverse(),[h(S),h(A)]}function G(f,d){var m=f.length,b=w(m),S=t,A,_,O,q;for(O=0,A=m-1;A>=0;--A)q=O*S+f[A],_=x(q/d),O=q-_*d,b[A]=_|0;return[b,O|0]}function T(f,d){var m,b=tt(d),S=f.value,A=b.value,_;if(A===0)throw new Error("Cannot divide by zero");if(f.isSmall)return b.isSmall?[new a(x(S/A)),new a(S%A)]:[i[0],f];if(b.isSmall){if(A===1)return[f,i[0]];if(A==-1)return[f.negate(),i[0]];var O=Math.abs(A);if(O<t){m=G(S,O),_=h(m[0]);var q=m[1];return f.sign&&(q=-q),typeof _=="number"?(f.sign!==b.sign&&(_=-_),[new a(_),new a(q)]):[new s(_,f.sign!==b.sign),new a(q)]}A=l(O)}var W=I(S,A);if(W===-1)return[i[0],f];if(W===0)return[i[f.sign===b.sign?1:-1],i[0]];S.length+A.length<=200?m=j(S,A):m=D(S,A),_=m[0];var et=f.sign!==b.sign,Q=m[1],rt=f.sign;return typeof _=="number"?(et&&(_=-_),_=new a(_)):_=new s(_,et),typeof Q=="number"?(rt&&(Q=-Q),Q=new a(Q)):Q=new s(Q,rt),[_,Q]}s.prototype.divmod=function(f){var d=T(this,f);return{quotient:d[0],remainder:d[1]}},a.prototype.divmod=s.prototype.divmod,s.prototype.divide=function(f){return T(this,f)[0]},a.prototype.over=a.prototype.divide=s.prototype.over=s.prototype.divide,s.prototype.mod=function(f){return T(this,f)[1]},a.prototype.remainder=a.prototype.mod=s.prototype.remainder=s.prototype.mod,s.prototype.pow=function(f){var d=tt(f),m=this.value,b=d.value,S,A,_;if(b===0)return i[1];if(m===0)return i[0];if(m===1)return i[1];if(m===-1)return d.isEven()?i[1]:i[-1];if(d.sign)return i[0];if(!d.isSmall)throw new Error("The exponent "+d.toString()+" is too large.");if(this.isSmall&&u(S=Math.pow(m,b)))return new a(x(S));for(A=this,_=i[1];b&!0&&(_=_.times(A),--b),b!==0;)b/=2,A=A.square();return _},a.prototype.pow=s.prototype.pow,s.prototype.modPow=function(f,d){if(f=tt(f),d=tt(d),d.isZero())throw new Error("Cannot take modPow with modulus 0");for(var m=i[1],b=this.mod(d);f.isPositive();){if(b.isZero())return i[0];f.isOdd()&&(m=m.multiply(b).mod(d)),f=f.divide(2),b=b.square().mod(d)}return m},a.prototype.modPow=s.prototype.modPow;function I(f,d){if(f.length!==d.length)return f.length>d.length?1:-1;for(var m=f.length-1;m>=0;m--)if(f[m]!==d[m])return f[m]>d[m]?1:-1;return 0}s.prototype.compareAbs=function(f){var d=tt(f),m=this.value,b=d.value;return d.isSmall?1:I(m,b)},a.prototype.compareAbs=function(f){var d=tt(f),m=Math.abs(this.value),b=d.value;return d.isSmall?(b=Math.abs(b),m===b?0:m>b?1:-1):-1},s.prototype.compare=function(f){if(f===1/0)return-1;if(f===-1/0)return 1;var d=tt(f),m=this.value,b=d.value;return this.sign!==d.sign?d.sign?1:-1:d.isSmall?this.sign?-1:1:I(m,b)*(this.sign?-1:1)},s.prototype.compareTo=s.prototype.compare,a.prototype.compare=function(f){if(f===1/0)return-1;if(f===-1/0)return 1;var d=tt(f),m=this.value,b=d.value;return d.isSmall?m==b?0:m>b?1:-1:m<0!==d.sign?m<0?-1:1:m<0?1:-1},a.prototype.compareTo=a.prototype.compare,s.prototype.equals=function(f){return this.compare(f)===0},a.prototype.eq=a.prototype.equals=s.prototype.eq=s.prototype.equals,s.prototype.notEquals=function(f){return this.compare(f)!==0},a.prototype.neq=a.prototype.notEquals=s.prototype.neq=s.prototype.notEquals,s.prototype.greater=function(f){return this.compare(f)>0},a.prototype.gt=a.prototype.greater=s.prototype.gt=s.prototype.greater,s.prototype.lesser=function(f){return this.compare(f)<0},a.prototype.lt=a.prototype.lesser=s.prototype.lt=s.prototype.lesser,s.prototype.greaterOrEquals=function(f){return this.compare(f)>=0},a.prototype.geq=a.prototype.greaterOrEquals=s.prototype.geq=s.prototype.greaterOrEquals,s.prototype.lesserOrEquals=function(f){return this.compare(f)<=0},a.prototype.leq=a.prototype.lesserOrEquals=s.prototype.leq=s.prototype.lesserOrEquals,s.prototype.isEven=function(){return(this.value[0]&1)===0},a.prototype.isEven=function(){return(this.value&1)===0},s.prototype.isOdd=function(){return(this.value[0]&1)===1},a.prototype.isOdd=function(){return(this.value&1)===1},s.prototype.isPositive=function(){return!this.sign},a.prototype.isPositive=function(){return this.value>0},s.prototype.isNegative=function(){return this.sign},a.prototype.isNegative=function(){return this.value<0},s.prototype.isUnit=function(){return!1},a.prototype.isUnit=function(){return Math.abs(this.value)===1},s.prototype.isZero=function(){return!1},a.prototype.isZero=function(){return this.value===0},s.prototype.isDivisibleBy=function(f){var d=tt(f),m=d.value;return m===0?!1:m===1?!0:m===2?this.isEven():this.mod(d).equals(i[0])},a.prototype.isDivisibleBy=s.prototype.isDivisibleBy;function R(f){var d=f.abs();if(d.isUnit())return!1;if(d.equals(2)||d.equals(3)||d.equals(5))return!0;if(d.isEven()||d.isDivisibleBy(3)||d.isDivisibleBy(5))return!1;if(d.lesser(49))return!0}function K(f,d){for(var m=f.prev(),b=m,S=0,A,_,O,q;b.isEven();)b=b.divide(2),S++;t:for(O=0;O<d.length;O++)if(!f.lesser(d[O])&&(q=st(d[O]).modPow(b,f),!(q.equals(i[1])||q.equals(m)))){for(A=S-1;A!=0;A--){if(q=q.square().mod(f),q.isUnit())return!1;if(q.equals(m))continue t}return!1}return!0}s.prototype.isPrime=function(f){var d=R(this);if(d!==e)return d;var m=this.abs(),b=m.bitLength();if(b<=64)return K(m,[2,325,9375,28178,450775,9780504,1795265022]);for(var S=Math.log(2)*b,A=Math.ceil(f===!0?2*Math.pow(S,2):S),_=[],O=0;O<A;O++)_.push(st(O+2));return K(m,_)},a.prototype.isPrime=s.prototype.isPrime,s.prototype.isProbablePrime=function(f){var d=R(this);if(d!==e)return d;for(var m=this.abs(),b=f===e?5:f,S=[],A=0;A<b;A++)S.push(st.randBetween(2,m.minus(2)));return K(m,S)},a.prototype.isProbablePrime=s.prototype.isProbablePrime,s.prototype.modInv=function(f){for(var d=st.zero,m=st.one,b=tt(f),S=this.abs(),A,_,O;!S.equals(st.zero);)A=b.divide(S),_=d,O=b,d=m,b=S,m=_.subtract(A.multiply(m)),S=O.subtract(A.multiply(S));if(!b.equals(1))throw new Error(this.toString()+" and "+f.toString()+" are not co-prime");return d.compare(0)===-1&&(d=d.add(f)),this.isNegative()?d.negate():d},a.prototype.modInv=s.prototype.modInv,s.prototype.next=function(){var f=this.value;return this.sign?B(f,1,this.sign):new s(v(f,1),this.sign)},a.prototype.next=function(){var f=this.value;return f+1<n?new a(f+1):new s(o,!1)},s.prototype.prev=function(){var f=this.value;return this.sign?new s(v(f,1),!0):B(f,1,this.sign)},a.prototype.prev=function(){var f=this.value;return f-1>-n?new a(f-1):new s(o,!0)};for(var C=[1];2*C[C.length-1]<=t;)C.push(2*C[C.length-1]);var Z=C.length,Y=C[Z-1];function X(f){return(typeof f=="number"||typeof f=="string")&&+Math.abs(f)<=t||f instanceof s&&f.value.length<=1}s.prototype.shiftLeft=function(f){if(!X(f))throw new Error(String(f)+" is too large for shifting.");if(f=+f,f<0)return this.shiftRight(-f);var d=this;if(d.isZero())return d;for(;f>=Z;)d=d.multiply(Y),f-=Z-1;return d.multiply(C[f])},a.prototype.shiftLeft=s.prototype.shiftLeft,s.prototype.shiftRight=function(f){var d;if(!X(f))throw new Error(String(f)+" is too large for shifting.");if(f=+f,f<0)return this.shiftLeft(-f);for(var m=this;f>=Z;){if(m.isZero()||m.isNegative()&&m.isUnit())return m;d=T(m,Y),m=d[1].isNegative()?d[0].prev():d[0],f-=Z-1}return d=T(m,C[f]),d[1].isNegative()?d[0].prev():d[0]},a.prototype.shiftRight=s.prototype.shiftRight;function nt(f,d,m){d=tt(d);for(var b=f.isNegative(),S=d.isNegative(),A=b?f.not():f,_=S?d.not():d,O=0,q=0,W=null,et=null,Q=[];!A.isZero()||!_.isZero();)W=T(A,Y),O=W[1].toJSNumber(),b&&(O=Y-1-O),et=T(_,Y),q=et[1].toJSNumber(),S&&(q=Y-1-q),A=W[0],_=et[0],Q.push(m(O,q));for(var rt=m(b?1:0,S?1:0)!==0?st(-1):st(0),vt=Q.length-1;vt>=0;vt-=1)rt=rt.multiply(Y).add(st(Q[vt]));return rt}s.prototype.not=function(){return this.negate().prev()},a.prototype.not=s.prototype.not,s.prototype.and=function(f){return nt(this,f,function(d,m){return d&m})},a.prototype.and=s.prototype.and,s.prototype.or=function(f){return nt(this,f,function(d,m){return d|m})},a.prototype.or=s.prototype.or,s.prototype.xor=function(f){return nt(this,f,function(d,m){return d^m})},a.prototype.xor=s.prototype.xor;var ft=1<<30,yt=(t&-t)*(t&-t)|ft;function lt(f){var d=f.value,m=typeof d=="number"?d|ft:d[0]+d[1]*t|yt;return m&-m}function ut(f,d){if(d.compareTo(f)<=0){var m=ut(f,d.square(d)),b=m.p,S=m.e,A=b.multiply(d);return A.compareTo(f)<=0?{p:A,e:S*2+1}:{p:b,e:S*2}}return{p:st(1),e:0}}s.prototype.bitLength=function(){var f=this;return f.compareTo(st(0))<0&&(f=f.negate().subtract(st(1))),f.compareTo(st(0))===0?st(0):st(ut(f,st(2)).e).add(st(1))},a.prototype.bitLength=s.prototype.bitLength;function At(f,d){return f=tt(f),d=tt(d),f.greater(d)?f:d}function ht(f,d){return f=tt(f),d=tt(d),f.lesser(d)?f:d}function Pt(f,d){if(f=tt(f).abs(),d=tt(d).abs(),f.equals(d))return f;if(f.isZero())return d;if(d.isZero())return f;for(var m=i[1],b,S;f.isEven()&&d.isEven();)b=Math.min(lt(f),lt(d)),f=f.divide(b),d=d.divide(b),m=m.multiply(b);for(;f.isEven();)f=f.divide(lt(f));do{for(;d.isEven();)d=d.divide(lt(d));f.greater(d)&&(S=d,d=f,f=S),d=d.subtract(f)}while(!d.isZero());return m.isUnit()?f:f.multiply(m)}function Xe(f,d){return f=tt(f).abs(),d=tt(d).abs(),f.divide(Pt(f,d)).multiply(d)}function St(f,d){f=tt(f),d=tt(d);var m=ht(f,d),b=At(f,d),S=b.subtract(m).add(1);if(S.isSmall)return m.add(Math.floor(Math.random()*S));for(var A=S.value.length-1,_=[],O=!0,q=A;q>=0;q--){var W=O?S.value[q]:t,et=x(Math.random()*W);_.unshift(et),et<W&&(O=!1)}return _=h(_),m.add(typeof _=="number"?new a(_):new s(_,!1))}var Wt=function(f,d){for(var m=f.length,b,S=Math.abs(d),b=0;b<m;b++){var A=f[b].toLowerCase();if(A!=="-"&&/[a-z0-9]/.test(A)){if(/[0-9]/.test(A)&&+A>=S){if(A==="1"&&S===1)continue;throw new Error(A+" is not a valid digit in base "+d+".")}else if(A.charCodeAt(0)-87>=S)throw new Error(A+" is not a valid digit in base "+d+".")}}if(2<=d&&d<=36&&m<=c/Math.log(d)){var _=parseInt(f,d);if(isNaN(_))throw new Error(A+" is not a valid digit in base "+d+".");return new a(parseInt(f,d))}d=tt(d);var O=[],q=f[0]==="-";for(b=q?1:0;b<f.length;b++){var A=f[b].toLowerCase(),W=A.charCodeAt(0);if(48<=W&&W<=57)O.push(tt(A));else if(97<=W&&W<=122)O.push(tt(A.charCodeAt(0)-87));else if(A==="<"){var et=b;do b++;while(f[b]!==">");O.push(tt(f.slice(et+1,b)))}else throw new Error(A+" is not a valid character")}return ce(O,d,q)};function ce(f,d,m){var b=i[0],S=i[1],A;for(A=f.length-1;A>=0;A--)b=b.add(f[A].times(S)),S=S.times(d);return m?b.negate():b}function Fe(f){return f<=35?"0123456789abcdefghijklmnopqrstuvwxyz".charAt(f):"<"+f+">"}function ve(f,d){if(d=st(d),d.isZero()){if(f.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(d.equals(-1)){if(f.isZero())return{value:[0],isNegative:!1};if(f.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-f)).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var m=Array.apply(null,Array(+f-1)).map(Array.prototype.valueOf,[0,1]);return m.unshift([1]),{value:[].concat.apply([],m),isNegative:!1}}var b=!1;if(f.isNegative()&&d.isPositive()&&(b=!0,f=f.abs()),d.equals(1))return f.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(+f)).map(Number.prototype.valueOf,1),isNegative:b};for(var S=[],A=f,_;A.isNegative()||A.compareAbs(d)>=0;){_=A.divmod(d),A=_.quotient;var O=_.remainder;O.isNegative()&&(O=d.minus(O).abs(),A=A.next()),S.push(O.toJSNumber())}return S.push(A.toJSNumber()),{value:S.reverse(),isNegative:b}}function ho(f,d){var m=ve(f,d);return(m.isNegative?"-":"")+m.value.map(Fe).join("")}s.prototype.toArray=function(f){return ve(this,f)},a.prototype.toArray=function(f){return ve(this,f)},s.prototype.toString=function(f){if(f===e&&(f=10),f!==10)return ho(this,f);for(var d=this.value,m=d.length,b=String(d[--m]),S="0000000",A;--m>=0;)A=String(d[m]),b+=S.slice(A.length)+A;var _=this.sign?"-":"";return _+b},a.prototype.toString=function(f){return f===e&&(f=10),f!=10?ho(this,f):String(this.value)},s.prototype.toJSON=a.prototype.toJSON=function(){return this.toString()},s.prototype.valueOf=function(){return parseInt(this.toString(),10)},s.prototype.toJSNumber=s.prototype.valueOf,a.prototype.valueOf=function(){return this.value},a.prototype.toJSNumber=a.prototype.valueOf;function po(f){if(u(+f)){var d=+f;if(d===x(d))return new a(d);throw new Error("Invalid integer: "+f)}var m=f[0]==="-";m&&(f=f.slice(1));var b=f.split(/e/i);if(b.length>2)throw new Error("Invalid integer: "+b.join("e"));if(b.length===2){var S=b[1];if(S[0]==="+"&&(S=S.slice(1)),S=+S,S!==x(S)||!u(S))throw new Error("Invalid integer: "+S+" is not a valid exponent.");var A=b[0],_=A.indexOf(".");if(_>=0&&(S-=A.length-_-1,A=A.slice(0,_)+A.slice(_+1)),S<0)throw new Error("Cannot include negative exponent part for integers");A+=new Array(S+1).join("0"),f=A}var O=/^([0-9][0-9]*)$/.test(f);if(!O)throw new Error("Invalid integer: "+f);for(var q=[],W=f.length,et=r,Q=W-et;W>0;)q.push(+f.slice(Q,W)),Q-=et,Q<0&&(Q=0),W-=et;return y(q),new s(q,m)}function vi(f){if(u(f)){if(f!==x(f))throw new Error(f+" is not an integer.");return new a(f)}return po(f.toString())}function tt(f){return typeof f=="number"?vi(f):typeof f=="string"?po(f):f}for(var ae=0;ae<1e3;ae++)i[ae]=new a(ae),ae>0&&(i[-ae]=new a(-ae));return i.one=i[1],i.zero=i[0],i.minusOne=i[-1],i.max=At,i.min=ht,i.gcd=Pt,i.lcm=Xe,i.isInstance=function(f){return f instanceof s||f instanceof a},i.randBetween=St,i.fromArray=function(f,d,m){return ce(f.map(tt),tt(d||10),m)},i}();typeof Zr<"u"&&Zr.hasOwnProperty("exports")&&(Zr.exports=st);typeof define=="function"&&define.amd&&define("big-integer",[],function(){return st})});var ui=Ee((Yl,fi)=>{"use strict";var ai=Kr().validate;fi.exports=function(e,t,r,n){for(var o=n?Math.floor(e.length*t/r):Math.ceil(e.length*t/r),c=(1<<r)-1,i=new Uint8Array(o),s=0,a=0,u=0,l=0;l<e.length;++l){var h=e[l];for(ai(0<=h&&h>>t===0,"Invalid value: "+h+"."),a=a<<t|h,u+=t;u>=r;)u-=r,i[s]=a>>u&c,++s}return n?ai(u<t&&(a<<r-u&c)===0,"Input cannot be converted to "+r+" bits without padding, but strict mode was used."):u>0&&(i[s]=a<<r-u&c,++s),i}});var mi=Ee((Xl,xi)=>{"use strict";var li=ii(),Wa=ci(),hi=ui(),di=Kr(),Ae=di.validate;function Ga(e,t,r){Ae(typeof e=="string"&&Fa(e),"Invalid prefix: "+e+"."),Ae(typeof t=="string","Invalid type: "+t+"."),Ae(r instanceof Uint8Array,"Invalid hash: "+r+".");var n=be(pi(e),new Uint8Array(1)),o=Qa(t)+ef(r),c=nf(be(new Uint8Array([o]),r)),i=be(be(n,c),new Uint8Array(8)),s=be(c,Ja(gi(i)));return e+":"+li.encode(s)}function Ya(e){Ae(typeof e=="string"&&yi(e),"Invalid address: "+e+".");var t=e.toLowerCase().split(":");Ae(t.length===2,"Missing prefix: "+e+".");var r=t[0],n=li.decode(t[1]);Ae(sf(r,n),"Invalid checksum: "+e+".");var o=of(n.subarray(0,-8)),c=o[0],i=o.subarray(1);Ae(rf(c)===i.length*8,"Invalid hash size: "+e+".");var s=tf(c);return{prefix:r,type:s,hash:i}}var Wr=di.ValidationError,Xa=["bitcoincash","bchtest","bchreg"];function Fa(e){return yi(e)&&Xa.indexOf(e.toLowerCase())!==-1}function pi(e){for(var t=new Uint8Array(e.length),r=0;r<e.length;++r)t[r]=e[r].charCodeAt(0)&31;return t}function Ja(e){for(var t=new Uint8Array(8),r=0;r<8;++r)t[7-r]=e.and(31).toJSNumber(),e=e.shiftRight(5);return t}function Qa(e){switch(e){case"P2PKH":return 0;case"P2SH":return 8;default:throw new Wr("Invalid type: "+e+".")}}function tf(e){switch(e&120){case 0:return"P2PKH";case 8:return"P2SH";default:throw new Wr("Invalid address type in version byte: "+e+".")}}function ef(e){switch(e.length*8){case 160:return 0;case 192:return 1;case 224:return 2;case 256:return 3;case 320:return 4;case 384:return 5;case 448:return 6;case 512:return 7;default:throw new Wr("Invalid hash size: "+e.length+".")}}function rf(e){switch(e&7){case 0:return 160;case 1:return 192;case 2:return 224;case 3:return 256;case 4:return 320;case 5:return 384;case 6:return 448;case 7:return 512}}function nf(e){return hi(e,8,5)}function of(e){return hi(e,5,8,!0)}function be(e,t){var r=new Uint8Array(e.length+t.length);return r.set(e),r.set(t,e.length),r}function gi(e){for(var t=[656907472481,522768456162,0xf33e5fb3c4,748107326120,130178868336],r=Wa(1),n=0;n<e.length;++n){var o=e[n],c=r.shiftRight(35);r=r.and(34359738367).shiftLeft(5).xor(o);for(var i=0;i<t.length;++i)c.shiftRight(i).and(1).equals(1)&&(r=r.xor(t[i]))}return r.xor(1)}function sf(e,t){var r=be(pi(e),new Uint8Array(1)),n=be(r,t);return gi(n).equals(0)}function yi(e){return e===e.toLowerCase()||e===e.toUpperCase()}xi.exports={encode:Ga,decode:Ya,ValidationError:Wr}});var bt=tn(rn());function yo(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function nn(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function xo(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");yo(e.outputLen),yo(e.blockLen)}function Be(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function mo(e,t){nn(e);let r=t.outputLen;if(e.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}var Je=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;var wo=e=>e instanceof Uint8Array;var Qe=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),It=(e,t)=>e<<32-t|e>>>t,_i=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!_i)throw new Error("Non little-endian hardware is not supported");function ki(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function Me(e){if(typeof e=="string"&&(e=ki(e)),!wo(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}function bo(...e){let t=new Uint8Array(e.reduce((n,o)=>n+o.length,0)),r=0;return e.forEach(n=>{if(!wo(n))throw new Error("Uint8Array expected");t.set(n,r),r+=n.length}),t}var Se=class{clone(){return this._cloneInto()}},yf={}.toString;function Ao(e){let t=n=>e().update(Me(n)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function tr(e=32){if(Je&&typeof Je.getRandomValues=="function")return Je.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}function Oi(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);let o=BigInt(32),c=BigInt(4294967295),i=Number(r>>o&c),s=Number(r&c),a=n?4:0,u=n?0:4;e.setUint32(t+a,i,n),e.setUint32(t+u,s,n)}var er=class extends Se{constructor(t,r,n,o){super(),this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=Qe(this.buffer)}update(t){Be(this);let{view:r,buffer:n,blockLen:o}=this;t=Me(t);let c=t.length;for(let i=0;i<c;){let s=Math.min(o-this.pos,c-i);if(s===o){let a=Qe(t);for(;o<=c-i;i+=o)this.process(a,i);continue}n.set(t.subarray(i,i+s),this.pos),this.pos+=s,i+=s,this.pos===o&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){Be(this),mo(t,this),this.finished=!0;let{buffer:r,view:n,blockLen:o,isLE:c}=this,{pos:i}=this;r[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>o-i&&(this.process(n,0),i=0);for(let h=i;h<o;h++)r[h]=0;Oi(n,o-8,BigInt(this.length*8),c),this.process(n,0);let s=Qe(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let u=a/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<u;h++)s.setUint32(4*h,l[h],c)}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:r,buffer:n,length:o,finished:c,destroyed:i,pos:s}=this;return t.length=o,t.pos=s,t.finished=c,t.destroyed=i,o%r&&t.buffer.set(n),t}};var Hi=(e,t,r)=>e&t^~e&r,Ni=(e,t,r)=>e&t^e&r^t&r,Ci=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Gt=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Yt=new Uint32Array(64),on=class extends er{constructor(){super(64,32,8,!1),this.A=Gt[0]|0,this.B=Gt[1]|0,this.C=Gt[2]|0,this.D=Gt[3]|0,this.E=Gt[4]|0,this.F=Gt[5]|0,this.G=Gt[6]|0,this.H=Gt[7]|0}get(){let{A:t,B:r,C:n,D:o,E:c,F:i,G:s,H:a}=this;return[t,r,n,o,c,i,s,a]}set(t,r,n,o,c,i,s,a){this.A=t|0,this.B=r|0,this.C=n|0,this.D=o|0,this.E=c|0,this.F=i|0,this.G=s|0,this.H=a|0}process(t,r){for(let h=0;h<16;h++,r+=4)Yt[h]=t.getUint32(r,!1);for(let h=16;h<64;h++){let y=Yt[h-15],w=Yt[h-2],x=It(y,7)^It(y,18)^y>>>3,p=It(w,17)^It(w,19)^w>>>10;Yt[h]=p+Yt[h-7]+x+Yt[h-16]|0}let{A:n,B:o,C:c,D:i,E:s,F:a,G:u,H:l}=this;for(let h=0;h<64;h++){let y=It(s,6)^It(s,11)^It(s,25),w=l+y+Hi(s,a,u)+Ci[h]+Yt[h]|0,p=(It(n,2)^It(n,13)^It(n,22))+Ni(n,o,c)|0;l=u,u=a,a=s,s=i+w|0,i=c,c=o,o=n,n=w+p|0}n=n+this.A|0,o=o+this.B|0,c=c+this.C|0,i=i+this.D|0,s=s+this.E|0,a=a+this.F|0,u=u+this.G|0,l=l+this.H|0,this.set(n,o,c,i,s,a,u,l)}roundClean(){Yt.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var rr=Ao(()=>new on);var fn={};Ti(fn,{bitGet:()=>Vi,bitLen:()=>Di,bitMask:()=>$e,bitSet:()=>zi,bytesToHex:()=>fe,bytesToNumberBE:()=>dt,bytesToNumberLE:()=>sr,concatBytes:()=>Rt,createHmacDrbg:()=>an,ensureBytes:()=>it,equalBytes:()=>Mi,hexToBytes:()=>ue,hexToNumber:()=>cn,numberToBytesBE:()=>_t,numberToBytesLE:()=>ir,numberToHexUnpadded:()=>Bo,numberToVarBytesBE:()=>Ri,utf8ToBytes:()=>$i,validateObject:()=>Xt});var Eo=BigInt(0),nr=BigInt(1),qi=BigInt(2),or=e=>e instanceof Uint8Array,Pi=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function fe(e){if(!or(e))throw new Error("Uint8Array expected");let t="";for(let r=0;r<e.length;r++)t+=Pi[e[r]];return t}function Bo(e){let t=e.toString(16);return t.length&1?`0${t}`:t}function cn(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return BigInt(e===""?"0":`0x${e}`)}function ue(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);let t=e.length;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);let r=new Uint8Array(t/2);for(let n=0;n<r.length;n++){let o=n*2,c=e.slice(o,o+2),i=Number.parseInt(c,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");r[n]=i}return r}function dt(e){return cn(fe(e))}function sr(e){if(!or(e))throw new Error("Uint8Array expected");return cn(fe(Uint8Array.from(e).reverse()))}function _t(e,t){return ue(e.toString(16).padStart(t*2,"0"))}function ir(e,t){return _t(e,t).reverse()}function Ri(e){return ue(Bo(e))}function it(e,t,r){let n;if(typeof t=="string")try{n=ue(t)}catch(c){throw new Error(`${e} must be valid hex string, got "${t}". Cause: ${c}`)}else if(or(t))n=Uint8Array.from(t);else throw new Error(`${e} must be hex string or Uint8Array`);let o=n.length;if(typeof r=="number"&&o!==r)throw new Error(`${e} expected ${r} bytes, got ${o}`);return n}function Rt(...e){let t=new Uint8Array(e.reduce((n,o)=>n+o.length,0)),r=0;return e.forEach(n=>{if(!or(n))throw new Error("Uint8Array expected");t.set(n,r),r+=n.length}),t}function Mi(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function $i(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function Di(e){let t;for(t=0;e>Eo;e>>=nr,t+=1);return t}function Vi(e,t){return e>>BigInt(t)&nr}var zi=(e,t,r)=>e|(r?nr:Eo)<<BigInt(t),$e=e=>(qi<<BigInt(e-1))-nr,sn=e=>new Uint8Array(e),vo=e=>Uint8Array.from(e);function an(e,t,r){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=sn(e),o=sn(e),c=0,i=()=>{n.fill(1),o.fill(0),c=0},s=(...h)=>r(o,n,...h),a=(h=sn())=>{o=s(vo([0]),h),n=s(),h.length!==0&&(o=s(vo([1]),h),n=s())},u=()=>{if(c++>=1e3)throw new Error("drbg: tried 1000 values");let h=0,y=[];for(;h<t;){n=s();let w=n.slice();y.push(w),h+=n.length}return Rt(...y)};return(h,y)=>{i(),a(h);let w;for(;!(w=y(u()));)a();return i(),w}}var Ki={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",stringOrUint8Array:e=>typeof e=="string"||e instanceof Uint8Array,isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function Xt(e,t,r={}){let n=(o,c,i)=>{let s=Ki[c];if(typeof s!="function")throw new Error(`Invalid validator "${c}", expected function`);let a=e[o];if(!(i&&a===void 0)&&!s(a,e))throw new Error(`Invalid param ${String(o)}=${a} (${typeof a}), expected ${c}`)};for(let[o,c]of Object.entries(t))n(o,c,!1);for(let[o,c]of Object.entries(r))n(o,c,!0);return e}var at=BigInt(0),ot=BigInt(1),le=BigInt(2),ji=BigInt(3),un=BigInt(4),So=BigInt(5),Lo=BigInt(8),Zi=BigInt(9),Wi=BigInt(16);function ct(e,t){let r=e%t;return r>=at?r:t+r}function Gi(e,t,r){if(r<=at||t<at)throw new Error("Expected power/modulo > 0");if(r===ot)return at;let n=ot;for(;t>at;)t&ot&&(n=n*e%r),e=e*e%r,t>>=ot;return n}function Et(e,t,r){let n=e;for(;t-- >at;)n*=n,n%=r;return n}function cr(e,t){if(e===at||t<=at)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=ct(e,t),n=t,o=at,c=ot,i=ot,s=at;for(;r!==at;){let u=n/r,l=n%r,h=o-i*u,y=c-s*u;n=r,r=l,o=i,c=s,i=h,s=y}if(n!==ot)throw new Error("invert: does not exist");return ct(o,t)}function Yi(e){let t=(e-ot)/le,r,n,o;for(r=e-ot,n=0;r%le===at;r/=le,n++);for(o=le;o<e&&Gi(o,t,e)!==e-ot;o++);if(n===1){let i=(e+ot)/un;return function(a,u){let l=a.pow(u,i);if(!a.eql(a.sqr(l),u))throw new Error("Cannot find square root");return l}}let c=(r+ot)/le;return function(s,a){if(s.pow(a,t)===s.neg(s.ONE))throw new Error("Cannot find square root");let u=n,l=s.pow(s.mul(s.ONE,o),r),h=s.pow(a,c),y=s.pow(a,r);for(;!s.eql(y,s.ONE);){if(s.eql(y,s.ZERO))return s.ZERO;let w=1;for(let p=s.sqr(y);w<u&&!s.eql(p,s.ONE);w++)p=s.sqr(p);let x=s.pow(l,ot<<BigInt(u-w-1));l=s.sqr(x),h=s.mul(h,x),y=s.mul(y,l),u=w}return h}}function Xi(e){if(e%un===ji){let t=(e+ot)/un;return function(n,o){let c=n.pow(o,t);if(!n.eql(n.sqr(c),o))throw new Error("Cannot find square root");return c}}if(e%Lo===So){let t=(e-So)/Lo;return function(n,o){let c=n.mul(o,le),i=n.pow(c,t),s=n.mul(o,i),a=n.mul(n.mul(s,le),i),u=n.mul(s,n.sub(a,n.ONE));if(!n.eql(n.sqr(u),o))throw new Error("Cannot find square root");return u}}return e%Wi,Yi(e)}var Fi=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function ln(e){let t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=Fi.reduce((n,o)=>(n[o]="function",n),t);return Xt(e,r)}function Ji(e,t,r){if(r<at)throw new Error("Expected power > 0");if(r===at)return e.ONE;if(r===ot)return t;let n=e.ONE,o=t;for(;r>at;)r&ot&&(n=e.mul(n,o)),o=e.sqr(o),r>>=ot;return n}function Qi(e,t){let r=new Array(t.length),n=t.reduce((c,i,s)=>e.is0(i)?c:(r[s]=c,e.mul(c,i)),e.ONE),o=e.inv(n);return t.reduceRight((c,i,s)=>e.is0(i)?c:(r[s]=e.mul(c,r[s]),e.mul(c,i)),o),r}function hn(e,t){let r=t!==void 0?t:e.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function Uo(e,t,r=!1,n={}){if(e<=at)throw new Error(`Expected Field ORDER > 0, got ${e}`);let{nBitLength:o,nByteLength:c}=hn(e,t);if(c>2048)throw new Error("Field lengths over 2048 bytes are not supported");let i=Xi(e),s=Object.freeze({ORDER:e,BITS:o,BYTES:c,MASK:$e(o),ZERO:at,ONE:ot,create:a=>ct(a,e),isValid:a=>{if(typeof a!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof a}`);return at<=a&&a<e},is0:a=>a===at,isOdd:a=>(a&ot)===ot,neg:a=>ct(-a,e),eql:(a,u)=>a===u,sqr:a=>ct(a*a,e),add:(a,u)=>ct(a+u,e),sub:(a,u)=>ct(a-u,e),mul:(a,u)=>ct(a*u,e),pow:(a,u)=>Ji(s,a,u),div:(a,u)=>ct(a*cr(u,e),e),sqrN:a=>a*a,addN:(a,u)=>a+u,subN:(a,u)=>a-u,mulN:(a,u)=>a*u,inv:a=>cr(a,e),sqrt:n.sqrt||(a=>i(s,a)),invertBatch:a=>Qi(s,a),cmov:(a,u,l)=>l?u:a,toBytes:a=>r?ir(a,c):_t(a,c),fromBytes:a=>{if(a.length!==c)throw new Error(`Fp.fromBytes: expected ${c}, got ${a.length}`);return r?sr(a):dt(a)}});return Object.freeze(s)}function To(e){if(typeof e!="bigint")throw new Error("field order must be bigint");let t=e.toString(2).length;return Math.ceil(t/8)}function dn(e){let t=To(e);return t+Math.ceil(t/2)}function Io(e,t,r=!1){let n=e.length,o=To(t),c=dn(t);if(n<16||n<c||n>1024)throw new Error(`expected ${c}-1024 bytes of input, got ${n}`);let i=r?dt(e):sr(e),s=ct(i,t-ot)+ot;return r?ir(s,o):_t(s,o)}var ec=BigInt(0),pn=BigInt(1);function _o(e,t){let r=(o,c)=>{let i=c.negate();return o?i:c},n=o=>{let c=Math.ceil(t/o)+1,i=2**(o-1);return{windows:c,windowSize:i}};return{constTimeNegate:r,unsafeLadder(o,c){let i=e.ZERO,s=o;for(;c>ec;)c&pn&&(i=i.add(s)),s=s.double(),c>>=pn;return i},precomputeWindow(o,c){let{windows:i,windowSize:s}=n(c),a=[],u=o,l=u;for(let h=0;h<i;h++){l=u,a.push(l);for(let y=1;y<s;y++)l=l.add(u),a.push(l);u=l.double()}return a},wNAF(o,c,i){let{windows:s,windowSize:a}=n(o),u=e.ZERO,l=e.BASE,h=BigInt(2**o-1),y=2**o,w=BigInt(o);for(let x=0;x<s;x++){let p=x*a,g=Number(i&h);i>>=w,g>a&&(g-=y,i+=pn);let v=p,E=p+Math.abs(g)-1,k=x%2!==0,B=g<0;g===0?l=l.add(r(k,c[v])):u=u.add(r(B,c[E]))}return{p:u,f:l}},wNAFCached(o,c,i,s){let a=o._WINDOW_SIZE||1,u=c.get(o);return u||(u=this.precomputeWindow(o,a),a!==1&&c.set(o,s(u))),this.wNAF(a,u,i)}}}function gn(e){return ln(e.Fp),Xt(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...hn(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}function rc(e){let t=gn(e);Xt(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:n,a:o}=t;if(r){if(!n.eql(o,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}var{bytesToNumberBE:nc,hexToBytes:oc}=fn,he={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(e){let{Err:t}=he;if(e.length<2||e[0]!==2)throw new t("Invalid signature integer tag");let r=e[1],n=e.subarray(2,r+2);if(!r||n.length!==r)throw new t("Invalid signature integer: wrong length");if(n[0]&128)throw new t("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new t("Invalid signature integer: unnecessary leading zero");return{d:nc(n),l:e.subarray(r+2)}},toSig(e){let{Err:t}=he,r=typeof e=="string"?oc(e):e;if(!(r instanceof Uint8Array))throw new Error("ui8a expected");let n=r.length;if(n<2||r[0]!=48)throw new t("Invalid signature tag");if(r[1]!==n-2)throw new t("Invalid signature: incorrect length");let{d:o,l:c}=he._parseInt(r.subarray(2)),{d:i,l:s}=he._parseInt(c);if(s.length)throw new t("Invalid signature: left bytes after parsing");return{r:o,s:i}},hexFromSig(e){let t=u=>Number.parseInt(u[0],16)&8?"00"+u:u,r=u=>{let l=u.toString(16);return l.length&1?`0${l}`:l},n=t(r(e.s)),o=t(r(e.r)),c=n.length/2,i=o.length/2,s=r(c),a=r(i);return`30${r(i+c+4)}02${a}${o}02${s}${n}`}},Mt=BigInt(0),Lt=BigInt(1),kf=BigInt(2),ko=BigInt(3),Of=BigInt(4);function sc(e){let t=rc(e),{Fp:r}=t,n=t.toBytes||((x,p,g)=>{let v=p.toAffine();return Rt(Uint8Array.from([4]),r.toBytes(v.x),r.toBytes(v.y))}),o=t.fromBytes||(x=>{let p=x.subarray(1),g=r.fromBytes(p.subarray(0,r.BYTES)),v=r.fromBytes(p.subarray(r.BYTES,2*r.BYTES));return{x:g,y:v}});function c(x){let{a:p,b:g}=t,v=r.sqr(x),E=r.mul(v,x);return r.add(r.add(E,r.mul(x,p)),g)}if(!r.eql(r.sqr(t.Gy),c(t.Gx)))throw new Error("bad generator point: equation left != right");function i(x){return typeof x=="bigint"&&Mt<x&&x<t.n}function s(x){if(!i(x))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function a(x){let{allowedPrivateKeyLengths:p,nByteLength:g,wrapPrivateKey:v,n:E}=t;if(p&&typeof x!="bigint"){if(x instanceof Uint8Array&&(x=fe(x)),typeof x!="string"||!p.includes(x.length))throw new Error("Invalid key");x=x.padStart(g*2,"0")}let k;try{k=typeof x=="bigint"?x:dt(it("private key",x,g))}catch{throw new Error(`private key must be ${g} bytes, hex or bigint, not ${typeof x}`)}return v&&(k=ct(k,E)),s(k),k}let u=new Map;function l(x){if(!(x instanceof h))throw new Error("ProjectivePoint expected")}class h{constructor(p,g,v){if(this.px=p,this.py=g,this.pz=v,p==null||!r.isValid(p))throw new Error("x required");if(g==null||!r.isValid(g))throw new Error("y required");if(v==null||!r.isValid(v))throw new Error("z required")}static fromAffine(p){let{x:g,y:v}=p||{};if(!p||!r.isValid(g)||!r.isValid(v))throw new Error("invalid affine point");if(p instanceof h)throw new Error("projective point not allowed");let E=k=>r.eql(k,r.ZERO);return E(g)&&E(v)?h.ZERO:new h(g,v,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(p){let g=r.invertBatch(p.map(v=>v.pz));return p.map((v,E)=>v.toAffine(g[E])).map(h.fromAffine)}static fromHex(p){let g=h.fromAffine(o(it("pointHex",p)));return g.assertValidity(),g}static fromPrivateKey(p){return h.BASE.multiply(a(p))}_setWindowSize(p){this._WINDOW_SIZE=p,u.delete(this)}assertValidity(){if(this.is0()){if(t.allowInfinityPoint&&!r.is0(this.py))return;throw new Error("bad point: ZERO")}let{x:p,y:g}=this.toAffine();if(!r.isValid(p)||!r.isValid(g))throw new Error("bad point: x or y not FE");let v=r.sqr(g),E=c(p);if(!r.eql(v,E))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:p}=this.toAffine();if(r.isOdd)return!r.isOdd(p);throw new Error("Field doesn't support isOdd")}equals(p){l(p);let{px:g,py:v,pz:E}=this,{px:k,py:B,pz:L}=p,U=r.eql(r.mul(g,L),r.mul(k,E)),H=r.eql(r.mul(v,L),r.mul(B,E));return U&&H}negate(){return new h(this.px,r.neg(this.py),this.pz)}double(){let{a:p,b:g}=t,v=r.mul(g,ko),{px:E,py:k,pz:B}=this,L=r.ZERO,U=r.ZERO,H=r.ZERO,P=r.mul(E,E),z=r.mul(k,k),M=r.mul(B,B),N=r.mul(E,k);return N=r.add(N,N),H=r.mul(E,B),H=r.add(H,H),L=r.mul(p,H),U=r.mul(v,M),U=r.add(L,U),L=r.sub(z,U),U=r.add(z,U),U=r.mul(L,U),L=r.mul(N,L),H=r.mul(v,H),M=r.mul(p,M),N=r.sub(P,M),N=r.mul(p,N),N=r.add(N,H),H=r.add(P,P),P=r.add(H,P),P=r.add(P,M),P=r.mul(P,N),U=r.add(U,P),M=r.mul(k,B),M=r.add(M,M),P=r.mul(M,N),L=r.sub(L,P),H=r.mul(M,z),H=r.add(H,H),H=r.add(H,H),new h(L,U,H)}add(p){l(p);let{px:g,py:v,pz:E}=this,{px:k,py:B,pz:L}=p,U=r.ZERO,H=r.ZERO,P=r.ZERO,z=t.a,M=r.mul(t.b,ko),N=r.mul(g,k),j=r.mul(v,B),D=r.mul(E,L),G=r.add(g,v),T=r.add(k,B);G=r.mul(G,T),T=r.add(N,j),G=r.sub(G,T),T=r.add(g,E);let I=r.add(k,L);return T=r.mul(T,I),I=r.add(N,D),T=r.sub(T,I),I=r.add(v,E),U=r.add(B,L),I=r.mul(I,U),U=r.add(j,D),I=r.sub(I,U),P=r.mul(z,T),U=r.mul(M,D),P=r.add(U,P),U=r.sub(j,P),P=r.add(j,P),H=r.mul(U,P),j=r.add(N,N),j=r.add(j,N),D=r.mul(z,D),T=r.mul(M,T),j=r.add(j,D),D=r.sub(N,D),D=r.mul(z,D),T=r.add(T,D),N=r.mul(j,T),H=r.add(H,N),N=r.mul(I,T),U=r.mul(G,U),U=r.sub(U,N),N=r.mul(G,j),P=r.mul(I,P),P=r.add(P,N),new h(U,H,P)}subtract(p){return this.add(p.negate())}is0(){return this.equals(h.ZERO)}wNAF(p){return w.wNAFCached(this,u,p,g=>{let v=r.invertBatch(g.map(E=>E.pz));return g.map((E,k)=>E.toAffine(v[k])).map(h.fromAffine)})}multiplyUnsafe(p){let g=h.ZERO;if(p===Mt)return g;if(s(p),p===Lt)return this;let{endo:v}=t;if(!v)return w.unsafeLadder(this,p);let{k1neg:E,k1:k,k2neg:B,k2:L}=v.splitScalar(p),U=g,H=g,P=this;for(;k>Mt||L>Mt;)k&Lt&&(U=U.add(P)),L&Lt&&(H=H.add(P)),P=P.double(),k>>=Lt,L>>=Lt;return E&&(U=U.negate()),B&&(H=H.negate()),H=new h(r.mul(H.px,v.beta),H.py,H.pz),U.add(H)}multiply(p){s(p);let g=p,v,E,{endo:k}=t;if(k){let{k1neg:B,k1:L,k2neg:U,k2:H}=k.splitScalar(g),{p:P,f:z}=this.wNAF(L),{p:M,f:N}=this.wNAF(H);P=w.constTimeNegate(B,P),M=w.constTimeNegate(U,M),M=new h(r.mul(M.px,k.beta),M.py,M.pz),v=P.add(M),E=z.add(N)}else{let{p:B,f:L}=this.wNAF(g);v=B,E=L}return h.normalizeZ([v,E])[0]}multiplyAndAddUnsafe(p,g,v){let E=h.BASE,k=(L,U)=>U===Mt||U===Lt||!L.equals(E)?L.multiplyUnsafe(U):L.multiply(U),B=k(this,g).add(k(p,v));return B.is0()?void 0:B}toAffine(p){let{px:g,py:v,pz:E}=this,k=this.is0();p==null&&(p=k?r.ONE:r.inv(E));let B=r.mul(g,p),L=r.mul(v,p),U=r.mul(E,p);if(k)return{x:r.ZERO,y:r.ZERO};if(!r.eql(U,r.ONE))throw new Error("invZ was invalid");return{x:B,y:L}}isTorsionFree(){let{h:p,isTorsionFree:g}=t;if(p===Lt)return!0;if(g)return g(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:p,clearCofactor:g}=t;return p===Lt?this:g?g(h,this):this.multiplyUnsafe(t.h)}toRawBytes(p=!0){return this.assertValidity(),n(h,this,p)}toHex(p=!0){return fe(this.toRawBytes(p))}}h.BASE=new h(t.Gx,t.Gy,r.ONE),h.ZERO=new h(r.ZERO,r.ONE,r.ZERO);let y=t.nBitLength,w=_o(h,t.endo?Math.ceil(y/2):y);return{CURVE:t,ProjectivePoint:h,normPrivateKeyToScalar:a,weierstrassEquation:c,isWithinCurveOrder:i}}function ic(e){let t=gn(e);return Xt(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function Oo(e){let t=ic(e),{Fp:r,n}=t,o=r.BYTES+1,c=2*r.BYTES+1;function i(T){return Mt<T&&T<r.ORDER}function s(T){return ct(T,n)}function a(T){return cr(T,n)}let{ProjectivePoint:u,normPrivateKeyToScalar:l,weierstrassEquation:h,isWithinCurveOrder:y}=sc({...t,toBytes(T,I,R){let K=I.toAffine(),C=r.toBytes(K.x),Z=Rt;return R?Z(Uint8Array.from([I.hasEvenY()?2:3]),C):Z(Uint8Array.from([4]),C,r.toBytes(K.y))},fromBytes(T){let I=T.length,R=T[0],K=T.subarray(1);if(I===o&&(R===2||R===3)){let C=dt(K);if(!i(C))throw new Error("Point is not on curve");let Z=h(C),Y=r.sqrt(Z),X=(Y&Lt)===Lt;return(R&1)===1!==X&&(Y=r.neg(Y)),{x:C,y:Y}}else if(I===c&&R===4){let C=r.fromBytes(K.subarray(0,r.BYTES)),Z=r.fromBytes(K.subarray(r.BYTES,2*r.BYTES));return{x:C,y:Z}}else throw new Error(`Point of length ${I} was invalid. Expected ${o} compressed bytes or ${c} uncompressed bytes`)}}),w=T=>fe(_t(T,t.nByteLength));function x(T){let I=n>>Lt;return T>I}function p(T){return x(T)?s(-T):T}let g=(T,I,R)=>dt(T.slice(I,R));class v{constructor(I,R,K){this.r=I,this.s=R,this.recovery=K,this.assertValidity()}static fromCompact(I){let R=t.nByteLength;return I=it("compactSignature",I,R*2),new v(g(I,0,R),g(I,R,2*R))}static fromDER(I){let{r:R,s:K}=he.toSig(it("DER",I));return new v(R,K)}assertValidity(){if(!y(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!y(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(I){return new v(this.r,this.s,I)}recoverPublicKey(I){let{r:R,s:K,recovery:C}=this,Z=H(it("msgHash",I));if(C==null||![0,1,2,3].includes(C))throw new Error("recovery id invalid");let Y=C===2||C===3?R+t.n:R;if(Y>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");let X=(C&1)===0?"02":"03",nt=u.fromHex(X+w(Y)),ft=a(Y),yt=s(-Z*ft),lt=s(K*ft),ut=u.BASE.multiplyAndAddUnsafe(nt,yt,lt);if(!ut)throw new Error("point at infinify");return ut.assertValidity(),ut}hasHighS(){return x(this.s)}normalizeS(){return this.hasHighS()?new v(this.r,s(-this.s),this.recovery):this}toDERRawBytes(){return ue(this.toDERHex())}toDERHex(){return he.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return ue(this.toCompactHex())}toCompactHex(){return w(this.r)+w(this.s)}}let E={isValidPrivateKey(T){try{return l(T),!0}catch{return!1}},normPrivateKeyToScalar:l,randomPrivateKey:()=>{let T=dn(t.n);return Io(t.randomBytes(T),t.n)},precompute(T=8,I=u.BASE){return I._setWindowSize(T),I.multiply(BigInt(3)),I}};function k(T,I=!0){return u.fromPrivateKey(T).toRawBytes(I)}function B(T){let I=T instanceof Uint8Array,R=typeof T=="string",K=(I||R)&&T.length;return I?K===o||K===c:R?K===2*o||K===2*c:T instanceof u}function L(T,I,R=!0){if(B(T))throw new Error("first arg must be private key");if(!B(I))throw new Error("second arg must be public key");return u.fromHex(I).multiply(l(T)).toRawBytes(R)}let U=t.bits2int||function(T){let I=dt(T),R=T.length*8-t.nBitLength;return R>0?I>>BigInt(R):I},H=t.bits2int_modN||function(T){return s(U(T))},P=$e(t.nBitLength);function z(T){if(typeof T!="bigint")throw new Error("bigint expected");if(!(Mt<=T&&T<P))throw new Error(`bigint expected < 2^${t.nBitLength}`);return _t(T,t.nByteLength)}function M(T,I,R=N){if(["recovered","canonical"].some(ht=>ht in R))throw new Error("sign() legacy options not supported");let{hash:K,randomBytes:C}=t,{lowS:Z,prehash:Y,extraEntropy:X}=R;Z==null&&(Z=!0),T=it("msgHash",T),Y&&(T=it("prehashed msgHash",K(T)));let nt=H(T),ft=l(I),yt=[z(ft),z(nt)];if(X!=null){let ht=X===!0?C(r.BYTES):X;yt.push(it("extraEntropy",ht))}let lt=Rt(...yt),ut=nt;function At(ht){let Pt=U(ht);if(!y(Pt))return;let Xe=a(Pt),St=u.BASE.multiply(Pt).toAffine(),Wt=s(St.x);if(Wt===Mt)return;let ce=s(Xe*s(ut+Wt*ft));if(ce===Mt)return;let Fe=(St.x===Wt?0:2)|Number(St.y&Lt),ve=ce;return Z&&x(ce)&&(ve=p(ce),Fe^=1),new v(Wt,ve,Fe)}return{seed:lt,k2sig:At}}let N={lowS:t.lowS,prehash:!1},j={lowS:t.lowS,prehash:!1};function D(T,I,R=N){let{seed:K,k2sig:C}=M(T,I,R),Z=t;return an(Z.hash.outputLen,Z.nByteLength,Z.hmac)(K,C)}u.BASE._setWindowSize(8);function G(T,I,R,K=j){let C=T;if(I=it("msgHash",I),R=it("publicKey",R),"strict"in K)throw new Error("options.strict was renamed to lowS");let{lowS:Z,prehash:Y}=K,X,nt;try{if(typeof C=="string"||C instanceof Uint8Array)try{X=v.fromDER(C)}catch(St){if(!(St instanceof he.Err))throw St;X=v.fromCompact(C)}else if(typeof C=="object"&&typeof C.r=="bigint"&&typeof C.s=="bigint"){let{r:St,s:Wt}=C;X=new v(St,Wt)}else throw new Error("PARSE");nt=u.fromHex(R)}catch(St){if(St.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(Z&&X.hasHighS())return!1;Y&&(I=t.hash(I));let{r:ft,s:yt}=X,lt=H(I),ut=a(yt),At=s(lt*ut),ht=s(ft*ut),Pt=u.BASE.multiplyAndAddUnsafe(nt,At,ht)?.toAffine();return Pt?s(Pt.x)===ft:!1}return{CURVE:t,getPublicKey:k,getSharedSecret:L,sign:D,verify:G,ProjectivePoint:u,Signature:v,utils:E}}var ar=class extends Se{constructor(t,r){super(),this.finished=!1,this.destroyed=!1,xo(t);let n=Me(r);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let o=this.blockLen,c=new Uint8Array(o);c.set(n.length>o?t.create().update(n).digest():n);for(let i=0;i<c.length;i++)c[i]^=54;this.iHash.update(c),this.oHash=t.create();for(let i=0;i<c.length;i++)c[i]^=106;this.oHash.update(c),c.fill(0)}update(t){return Be(this),this.iHash.update(t),this}digestInto(t){Be(this),nn(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:o,destroyed:c,blockLen:i,outputLen:s}=this;return t=t,t.finished=o,t.destroyed=c,t.blockLen=i,t.outputLen=s,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},yn=(e,t,r)=>new ar(e,t).update(r).digest();yn.create=(e,t)=>new ar(e,t);function cc(e){return{hash:e,hmac:(t,...r)=>yn(e,t,bo(...r)),randomBytes:tr}}function Ho(e,t){let r=n=>Oo({...e,...cc(n)});return Object.freeze({...r(t),create:r})}var hr=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),fr=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),qo=BigInt(1),ur=BigInt(2),No=(e,t)=>(e+t/ur)/t;function Po(e){let t=hr,r=BigInt(3),n=BigInt(6),o=BigInt(11),c=BigInt(22),i=BigInt(23),s=BigInt(44),a=BigInt(88),u=e*e*e%t,l=u*u*e%t,h=Et(l,r,t)*l%t,y=Et(h,r,t)*l%t,w=Et(y,ur,t)*u%t,x=Et(w,o,t)*w%t,p=Et(x,c,t)*x%t,g=Et(p,s,t)*p%t,v=Et(g,a,t)*g%t,E=Et(v,s,t)*p%t,k=Et(E,r,t)*l%t,B=Et(k,i,t)*x%t,L=Et(B,n,t)*u%t,U=Et(L,ur,t);if(!mn.eql(mn.sqr(U),e))throw new Error("Cannot find square root");return U}var mn=Uo(hr,void 0,void 0,{sqrt:Po}),Ft=Ho({a:BigInt(0),b:BigInt(7),Fp:mn,n:fr,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{let t=fr,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-qo*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),c=r,i=BigInt("0x100000000000000000000000000000000"),s=No(c*e,t),a=No(-n*e,t),u=ct(e-s*r-a*o,t),l=ct(-s*n-a*c,t),h=u>i,y=l>i;if(h&&(u=t-u),y&&(l=t-l),u>i||l>i)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:h,k1:u,k2neg:y,k2:l}}}},rr),dr=BigInt(0),Ro=e=>typeof e=="bigint"&&dr<e&&e<hr,ac=e=>typeof e=="bigint"&&dr<e&&e<fr,Co={};function lr(e,...t){let r=Co[e];if(r===void 0){let n=rr(Uint8Array.from(e,o=>o.charCodeAt(0)));r=Rt(n,n),Co[e]=r}return rr(Rt(r,...t))}var An=e=>e.toRawBytes(!0).slice(1),wn=e=>_t(e,32),xn=e=>ct(e,hr),De=e=>ct(e,fr),vn=Ft.ProjectivePoint,fc=(e,t,r)=>vn.BASE.multiplyAndAddUnsafe(e,t,r);function bn(e){let t=Ft.utils.normPrivateKeyToScalar(e),r=vn.fromPrivateKey(t);return{scalar:r.hasEvenY()?t:De(-t),bytes:An(r)}}function Mo(e){if(!Ro(e))throw new Error("bad x: need 0 < x < p");let t=xn(e*e),r=xn(t*e+BigInt(7)),n=Po(r);n%ur!==dr&&(n=xn(-n));let o=new vn(e,n,qo);return o.assertValidity(),o}function $o(...e){return De(dt(lr("BIP0340/challenge",...e)))}function uc(e){return bn(e).bytes}function lc(e,t,r=tr(32)){let n=it("message",e),{bytes:o,scalar:c}=bn(t),i=it("auxRand",r,32),s=wn(c^dt(lr("BIP0340/aux",i))),a=lr("BIP0340/nonce",s,o,n),u=De(dt(a));if(u===dr)throw new Error("sign failed: k is zero");let{bytes:l,scalar:h}=bn(u),y=$o(l,o,n),w=new Uint8Array(64);if(w.set(l,0),w.set(wn(De(h+y*c)),32),!Do(w,n,o))throw new Error("sign: Invalid signature produced");return w}function Do(e,t,r){let n=it("signature",e,64),o=it("message",t),c=it("publicKey",r,32);try{let i=Mo(dt(c)),s=dt(n.subarray(0,32));if(!Ro(s))return!1;let a=dt(n.subarray(32,64));if(!ac(a))return!1;let u=$o(wn(s),An(i),o),l=fc(i,a,De(-u));return!(!l||!l.hasEvenY()||l.toAffine().x!==s)}catch{return!1}}var Le={getPublicKey:uc,sign:lc,verify:Do,utils:{randomPrivateKey:Ft.utils.randomPrivateKey,lift_x:Mo,pointToBytes:An,numberToBytesBE:_t,bytesToNumberBE:dt,taggedHash:lr,mod:ct}};var pr=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;var En=e=>e instanceof Uint8Array;var gr=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),kt=(e,t)=>e<<32-t|e>>>t,hc=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!hc)throw new Error("Non little-endian hardware is not supported");var dc=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function gt(e){if(!En(e))throw new Error("Uint8Array expected");let t="";for(let r=0;r<e.length;r++)t+=dc[e[r]];return t}function pc(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function Jt(e){if(typeof e=="string"&&(e=pc(e)),!En(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}function Ve(...e){let t=new Uint8Array(e.reduce((n,o)=>n+o.length,0)),r=0;return e.forEach(n=>{if(!En(n))throw new Error("Uint8Array expected");t.set(n,r),r+=n.length}),t}var Ue=class{clone(){return this._cloneInto()}};function Bn(e){let t=n=>e().update(Jt(n)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function yr(e=32){if(pr&&typeof pr.getRandomValues=="function")return pr.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}function Sn(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function gc(e){if(typeof e!="boolean")throw new Error(`Expected boolean, not ${e}`)}function Vo(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function yc(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Sn(e.outputLen),Sn(e.blockLen)}function xc(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function mc(e,t){Vo(e);let r=t.outputLen;if(e.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}var wc={number:Sn,bool:gc,bytes:Vo,hash:yc,exists:xc,output:mc},Bt=wc;function bc(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);let o=BigInt(32),c=BigInt(4294967295),i=Number(r>>o&c),s=Number(r&c),a=n?4:0,u=n?0:4;e.setUint32(t+a,i,n),e.setUint32(t+u,s,n)}var xr=class extends Ue{constructor(t,r,n,o){super(),this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=gr(this.buffer)}update(t){Bt.exists(this);let{view:r,buffer:n,blockLen:o}=this;t=Jt(t);let c=t.length;for(let i=0;i<c;){let s=Math.min(o-this.pos,c-i);if(s===o){let a=gr(t);for(;o<=c-i;i+=o)this.process(a,i);continue}n.set(t.subarray(i,i+s),this.pos),this.pos+=s,i+=s,this.pos===o&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){Bt.exists(this),Bt.output(t,this),this.finished=!0;let{buffer:r,view:n,blockLen:o,isLE:c}=this,{pos:i}=this;r[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>o-i&&(this.process(n,0),i=0);for(let h=i;h<o;h++)r[h]=0;bc(n,o-8,BigInt(this.length*8),c),this.process(n,0);let s=gr(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let u=a/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<u;h++)s.setUint32(4*h,l[h],c)}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:r,buffer:n,length:o,finished:c,destroyed:i,pos:s}=this;return t.length=o,t.pos=s,t.finished=c,t.destroyed=i,o%r&&t.buffer.set(n),t}};var Ac=(e,t,r)=>e&t^~e&r,vc=(e,t,r)=>e&t^e&r^t&r,Ec=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Qt=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),te=new Uint32Array(64),mr=class extends xr{constructor(){super(64,32,8,!1),this.A=Qt[0]|0,this.B=Qt[1]|0,this.C=Qt[2]|0,this.D=Qt[3]|0,this.E=Qt[4]|0,this.F=Qt[5]|0,this.G=Qt[6]|0,this.H=Qt[7]|0}get(){let{A:t,B:r,C:n,D:o,E:c,F:i,G:s,H:a}=this;return[t,r,n,o,c,i,s,a]}set(t,r,n,o,c,i,s,a){this.A=t|0,this.B=r|0,this.C=n|0,this.D=o|0,this.E=c|0,this.F=i|0,this.G=s|0,this.H=a|0}process(t,r){for(let h=0;h<16;h++,r+=4)te[h]=t.getUint32(r,!1);for(let h=16;h<64;h++){let y=te[h-15],w=te[h-2],x=kt(y,7)^kt(y,18)^y>>>3,p=kt(w,17)^kt(w,19)^w>>>10;te[h]=p+te[h-7]+x+te[h-16]|0}let{A:n,B:o,C:c,D:i,E:s,F:a,G:u,H:l}=this;for(let h=0;h<64;h++){let y=kt(s,6)^kt(s,11)^kt(s,25),w=l+y+Ac(s,a,u)+Ec[h]+te[h]|0,p=(kt(n,2)^kt(n,13)^kt(n,22))+vc(n,o,c)|0;l=u,u=a,a=s,s=i+w|0,i=c,c=o,o=n,n=w+p|0}n=n+this.A|0,o=o+this.B|0,c=c+this.C|0,i=i+this.D|0,s=s+this.E|0,a=a+this.F|0,u=u+this.G|0,l=l+this.H|0,this.set(n,o,c,i,s,a,u,l)}roundClean(){te.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}},Ln=class extends mr{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}},Te=Bn(()=>new mr),ru=Bn(()=>new Ln);var Ie=Symbol("verified"),Bc=e=>e instanceof Object;function Tn(e){if(!Bc(e)||typeof e.kind!="number"||typeof e.content!="string"||typeof e.created_at!="number"||typeof e.pubkey!="string"||!e.pubkey.match(/^[a-f0-9]{64}$/)||!Array.isArray(e.tags))return!1;for(let t=0;t<e.tags.length;t++){let r=e.tags[t];if(!Array.isArray(r))return!1;for(let n=0;n<r.length;n++)if(typeof r[n]!="string")return!1}return!0}var uu=new TextDecoder("utf-8"),Sc=new TextEncoder,Lc=class{generateSecretKey(){return Le.utils.randomPrivateKey()}getPublicKey(e){return gt(Le.getPublicKey(e))}finalizeEvent(e,t){let r=e;return r.pubkey=gt(Le.getPublicKey(t)),r.id=Un(r),r.sig=gt(Le.sign(Un(r),t)),r[Ie]=!0,r}verifyEvent(e){if(typeof e[Ie]=="boolean")return e[Ie];let t=Un(e);if(t!==e.id)return e[Ie]=!1,!1;try{let r=Le.verify(e.sig,t,e.pubkey);return e[Ie]=r,r}catch{return e[Ie]=!1,!1}}};function Uc(e){if(!Tn(e))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,e.pubkey,e.created_at,e.kind,e.tags,e.content])}function Un(e){let t=Te(Sc.encode(Uc(e)));return gt(t)}var wr=new Lc,lu=wr.generateSecretKey,zo=wr.getPublicKey,Ko=wr.finalizeEvent,hu=wr.verifyEvent;function _e(e){if(!Number.isSafeInteger(e))throw new Error(`Wrong integer: ${e}`)}function $t(...e){let t=(o,c)=>i=>o(c(i)),r=Array.from(e).reverse().reduce((o,c)=>o?t(o,c.encode):c.encode,void 0),n=e.reduce((o,c)=>o?t(o,c.decode):c.decode,void 0);return{encode:r,decode:n}}function Dt(e){return{encode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return t.map(r=>{if(_e(r),r<0||r>=e.length)throw new Error(`Digit index outside alphabet: ${r} (alphabet: ${e.length})`);return e[r]})},decode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="string")throw new Error("alphabet.decode input should be array of strings");return t.map(r=>{if(typeof r!="string")throw new Error(`alphabet.decode: not string element=${r}`);let n=e.indexOf(r);if(n===-1)throw new Error(`Unknown letter: "${r}". Allowed: ${e}`);return n})}}}function Vt(e=""){if(typeof e!="string")throw new Error("join separator should be string");return{encode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="string")throw new Error("join.encode input should be array of strings");for(let r of t)if(typeof r!="string")throw new Error(`join.encode: non-string input=${r}`);return t.join(e)},decode:t=>{if(typeof t!="string")throw new Error("join.decode input should be string");return t.split(e)}}}function Ar(e,t="="){if(_e(e),typeof t!="string")throw new Error("padding chr should be string");return{encode(r){if(!Array.isArray(r)||r.length&&typeof r[0]!="string")throw new Error("padding.encode input should be array of strings");for(let n of r)if(typeof n!="string")throw new Error(`padding.encode: non-string input=${n}`);for(;r.length*e%8;)r.push(t);return r},decode(r){if(!Array.isArray(r)||r.length&&typeof r[0]!="string")throw new Error("padding.encode input should be array of strings");for(let o of r)if(typeof o!="string")throw new Error(`padding.decode: non-string input=${o}`);let n=r.length;if(n*e%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;n>0&&r[n-1]===t;n--)if(!((n-1)*e%8))throw new Error("Invalid padding: string has too much padding");return r.slice(0,n)}}}function Xo(e){if(typeof e!="function")throw new Error("normalize fn should be function");return{encode:t=>t,decode:t=>e(t)}}function jo(e,t,r){if(t<2)throw new Error(`convertRadix: wrong from=${t}, base cannot be less than 2`);if(r<2)throw new Error(`convertRadix: wrong to=${r}, base cannot be less than 2`);if(!Array.isArray(e))throw new Error("convertRadix: data should be array");if(!e.length)return[];let n=0,o=[],c=Array.from(e);for(c.forEach(i=>{if(_e(i),i<0||i>=t)throw new Error(`Wrong integer: ${i}`)});;){let i=0,s=!0;for(let a=n;a<c.length;a++){let u=c[a],l=t*i+u;if(!Number.isSafeInteger(l)||t*i/t!==i||l-u!==t*i)throw new Error("convertRadix: carry overflow");if(i=l%r,c[a]=Math.floor(l/r),!Number.isSafeInteger(c[a])||c[a]*r+i!==l)throw new Error("convertRadix: carry overflow");if(s)c[a]?s=!1:n=a;else continue}if(o.push(i),s)break}for(let i=0;i<e.length-1&&e[i]===0;i++)o.push(0);return o.reverse()}var Fo=(e,t)=>t?Fo(t,e%t):e,br=(e,t)=>e+(t-Fo(e,t));function In(e,t,r,n){if(!Array.isArray(e))throw new Error("convertRadix2: data should be array");if(t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(r<=0||r>32)throw new Error(`convertRadix2: wrong to=${r}`);if(br(t,r)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${r} carryBits=${br(t,r)}`);let o=0,c=0,i=2**r-1,s=[];for(let a of e){if(_e(a),a>=2**t)throw new Error(`convertRadix2: invalid data word=${a} from=${t}`);if(o=o<<t|a,c+t>32)throw new Error(`convertRadix2: carry overflow pos=${c} from=${t}`);for(c+=t;c>=r;c-=r)s.push((o>>c-r&i)>>>0);o&=2**c-1}if(o=o<<r-c&i,!n&&c>=t)throw new Error("Excess padding");if(!n&&o)throw new Error(`Non-zero padding: ${o}`);return n&&c>0&&s.push(o>>>0),s}function Tc(e){return _e(e),{encode:t=>{if(!(t instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return jo(Array.from(t),2**8,e)},decode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="number")throw new Error("radix.decode input should be array of strings");return Uint8Array.from(jo(t,e,2**8))}}}function ee(e,t=!1){if(_e(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(br(8,e)>32||br(e,8)>32)throw new Error("radix2: carry overflow");return{encode:r=>{if(!(r instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return In(Array.from(r),8,e,!t)},decode:r=>{if(!Array.isArray(r)||r.length&&typeof r[0]!="number")throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(In(r,e,8,t))}}}function Zo(e){if(typeof e!="function")throw new Error("unsafeWrapper fn should be function");return function(...t){try{return e.apply(null,t)}catch{}}}var Ic=$t(ee(4),Dt("0123456789ABCDEF"),Vt("")),_c=$t(ee(5),Dt("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),Ar(5),Vt("")),gu=$t(ee(5),Dt("0123456789ABCDEFGHIJKLMNOPQRSTUV"),Ar(5),Vt("")),yu=$t(ee(5),Dt("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),Vt(""),Xo(e=>e.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1"))),zt=$t(ee(6),Dt("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),Ar(6),Vt("")),kc=$t(ee(6),Dt("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),Ar(6),Vt("")),On=e=>$t(Tc(58),Dt(e),Vt("")),_n=On("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),xu=On("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),mu=On("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz"),Wo=[0,2,3,5,6,7,9,10,11],Oc={encode(e){let t="";for(let r=0;r<e.length;r+=8){let n=e.subarray(r,r+8);t+=_n.encode(n).padStart(Wo[n.length],"1")}return t},decode(e){let t=[];for(let r=0;r<e.length;r+=11){let n=e.slice(r,r+11),o=Wo.indexOf(n.length),c=_n.decode(n);for(let i=0;i<c.length-o;i++)if(c[i]!==0)throw new Error("base58xmr: wrong padding");t=t.concat(Array.from(c.slice(c.length-o)))}return Uint8Array.from(t)}};var kn=$t(Dt("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),Vt("")),Go=[996825010,642813549,513874426,1027748829,705979059];function ze(e){let t=e>>25,r=(e&33554431)<<5;for(let n=0;n<Go.length;n++)(t>>n&1)===1&&(r^=Go[n]);return r}function Yo(e,t,r=1){let n=e.length,o=1;for(let c=0;c<n;c++){let i=e.charCodeAt(c);if(i<33||i>126)throw new Error(`Invalid prefix (${e})`);o=ze(o)^i>>5}o=ze(o);for(let c=0;c<n;c++)o=ze(o)^e.charCodeAt(c)&31;for(let c of t)o=ze(o)^c;for(let c=0;c<6;c++)o=ze(o);return o^=r,kn.encode(In([o%2**30],30,5,!1))}function Jo(e){let t=e==="bech32"?1:734539939,r=ee(5),n=r.decode,o=r.encode,c=Zo(n);function i(l,h,y=90){if(typeof l!="string")throw new Error(`bech32.encode prefix should be string, not ${typeof l}`);if(!Array.isArray(h)||h.length&&typeof h[0]!="number")throw new Error(`bech32.encode words should be array of numbers, not ${typeof h}`);let w=l.length+7+h.length;if(y!==!1&&w>y)throw new TypeError(`Length ${w} exceeds limit ${y}`);return l=l.toLowerCase(),`${l}1${kn.encode(h)}${Yo(l,h,t)}`}function s(l,h=90){if(typeof l!="string")throw new Error(`bech32.decode input should be string, not ${typeof l}`);if(l.length<8||h!==!1&&l.length>h)throw new TypeError(`Wrong string length: ${l.length} (${l}). Expected (8..${h})`);let y=l.toLowerCase();if(l!==y&&l!==l.toUpperCase())throw new Error("String must be lowercase or uppercase");l=y;let w=l.lastIndexOf("1");if(w===0||w===-1)throw new Error('Letter "1" must be present between prefix and data only');let x=l.slice(0,w),p=l.slice(w+1);if(p.length<6)throw new Error("Data must be at least 6 characters long");let g=kn.decode(p).slice(0,-6),v=Yo(x,g,t);if(!p.endsWith(v))throw new Error(`Invalid checksum in ${l}: expected "${v}"`);return{prefix:x,words:g}}let a=Zo(s);function u(l){let{prefix:h,words:y}=s(l,!1);return{prefix:h,words:y,bytes:n(y)}}return{encode:i,decode:s,decodeToBytes:u,decodeUnsafe:a,fromWords:n,fromWordsUnsafe:c,toWords:o}}var Hn=Jo("bech32"),wu=Jo("bech32m"),Hc={encode:e=>new TextDecoder().decode(e),decode:e=>new TextEncoder().encode(e)},Nc=$t(ee(4),Dt("0123456789abcdef"),Vt(""),Xo(e=>{if(typeof e!="string"||e.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof e} with length ${e.length}`);return e.toLowerCase()})),Cc={utf8:Hc,hex:Nc,base16:Ic,base32:_c,base64:zt,base64url:kc,base58:_n,base58xmr:Oc},bu=`Invalid encoding type. Available types: ${Object.keys(Cc).join(", ")}`;var vr=new TextDecoder("utf-8"),Tu=new TextEncoder;var qc=5e3;function Qo(e){let{prefix:t,words:r}=Hn.decode(e,qc),n=new Uint8Array(Hn.fromWords(r));switch(t){case"nprofile":{let o=Nn(n);if(!o[0]?.[0])throw new Error("missing TLV 0 for nprofile");if(o[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");return{type:"nprofile",data:{pubkey:gt(o[0][0]),relays:o[1]?o[1].map(c=>vr.decode(c)):[]}}}case"nevent":{let o=Nn(n);if(!o[0]?.[0])throw new Error("missing TLV 0 for nevent");if(o[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");if(o[2]&&o[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(o[3]&&o[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"nevent",data:{id:gt(o[0][0]),relays:o[1]?o[1].map(c=>vr.decode(c)):[],author:o[2]?.[0]?gt(o[2][0]):void 0,kind:o[3]?.[0]?parseInt(gt(o[3][0]),16):void 0}}}case"naddr":{let o=Nn(n);if(!o[0]?.[0])throw new Error("missing TLV 0 for naddr");if(!o[2]?.[0])throw new Error("missing TLV 2 for naddr");if(o[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(!o[3]?.[0])throw new Error("missing TLV 3 for naddr");if(o[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"naddr",data:{identifier:vr.decode(o[0][0]),pubkey:gt(o[2][0]),kind:parseInt(gt(o[3][0]),16),relays:o[1]?o[1].map(c=>vr.decode(c)):[]}}}case"nsec":return{type:t,data:n};case"npub":case"note":return{type:t,data:gt(n)};default:throw new Error(`unknown prefix ${t}`)}}function Nn(e){let t={},r=e;for(;r.length>0;){let n=r[0],o=r[1],c=r.slice(2,2+o);if(r=r.slice(2+o),c.length<o)throw new Error(`not enough data to read on TLV ${n}`);t[n]=t[n]||[],t[n].push(c)}return t}function Er(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`positive integer expected, not ${e}`)}function Cn(e){if(typeof e!="boolean")throw new Error(`boolean expected, not ${e}`)}function qn(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}function F(e,...t){if(!qn(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error(`Uint8Array expected of length ${t}, not of length=${e.length}`)}function re(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Ke(e,t){F(e);let r=t.outputLen;if(e.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}var Br=e=>new Uint8Array(e.buffer,e.byteOffset,e.byteLength);var J=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),ne=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),Rc=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Rc)throw new Error("Non little-endian hardware is not supported");function Mc(e){if(typeof e!="string")throw new Error(`string expected, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function Ht(e){if(typeof e=="string")e=Mc(e);else if(qn(e))e=e.slice();else throw new Error(`Uint8Array expected, got ${typeof e}`);return e}function ts(e,t){if(t==null||typeof t!="object")throw new Error("options must be defined");return Object.assign(e,t)}function de(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return r===0}var Nt=(e,t)=>(Object.assign(t,e),t);function pe(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);let o=BigInt(32),c=BigInt(4294967295),i=Number(r>>o&c),s=Number(r&c),a=n?4:0,u=n?0:4;e.setUint32(t+a,i,n),e.setUint32(t+u,s,n)}var Kt=16,Rn=new Uint8Array(16),Ct=J(Rn),$c=225,Dc=(e,t,r,n)=>{let o=n&1;return{s3:r<<31|n>>>1,s2:t<<31|r>>>1,s1:e<<31|t>>>1,s0:e>>>1^$c<<24&-(o&1)}},Ut=e=>(e>>>0&255)<<24|(e>>>8&255)<<16|(e>>>16&255)<<8|e>>>24&255|0;function Vc(e){e.reverse();let t=e[15]&1,r=0;for(let n=0;n<e.length;n++){let o=e[n];e[n]=o>>>1|r,r=(o&1)<<7}return e[0]^=-t&225,e}var zc=e=>e>64*1024?8:e>1024?4:2,Sr=class{constructor(t,r){this.blockLen=Kt,this.outputLen=Kt,this.s0=0,this.s1=0,this.s2=0,this.s3=0,this.finished=!1,t=Ht(t),F(t,16);let n=ne(t),o=n.getUint32(0,!1),c=n.getUint32(4,!1),i=n.getUint32(8,!1),s=n.getUint32(12,!1),a=[];for(let x=0;x<128;x++)a.push({s0:Ut(o),s1:Ut(c),s2:Ut(i),s3:Ut(s)}),{s0:o,s1:c,s2:i,s3:s}=Dc(o,c,i,s);let u=zc(r||1024);if(![1,2,4,8].includes(u))throw new Error(`ghash: wrong window size=${u}, should be 2, 4 or 8`);this.W=u;let h=128/u,y=this.windowSize=2**u,w=[];for(let x=0;x<h;x++)for(let p=0;p<y;p++){let g=0,v=0,E=0,k=0;for(let B=0;B<u;B++){if(!(p>>>u-B-1&1))continue;let{s0:U,s1:H,s2:P,s3:z}=a[u*x+B];g^=U,v^=H,E^=P,k^=z}w.push({s0:g,s1:v,s2:E,s3:k})}this.t=w}_updateBlock(t,r,n,o){t^=this.s0,r^=this.s1,n^=this.s2,o^=this.s3;let{W:c,t:i,windowSize:s}=this,a=0,u=0,l=0,h=0,y=(1<<c)-1,w=0;for(let x of[t,r,n,o])for(let p=0;p<4;p++){let g=x>>>8*p&255;for(let v=8/c-1;v>=0;v--){let E=g>>>c*v&y,{s0:k,s1:B,s2:L,s3:U}=i[w*s+E];a^=k,u^=B,l^=L,h^=U,w+=1}}this.s0=a,this.s1=u,this.s2=l,this.s3=h}update(t){t=Ht(t),re(this);let r=J(t),n=Math.floor(t.length/Kt),o=t.length%Kt;for(let c=0;c<n;c++)this._updateBlock(r[c*4+0],r[c*4+1],r[c*4+2],r[c*4+3]);return o&&(Rn.set(t.subarray(n*Kt)),this._updateBlock(Ct[0],Ct[1],Ct[2],Ct[3]),Ct.fill(0)),this}destroy(){let{t}=this;for(let r of t)r.s0=0,r.s1=0,r.s2=0,r.s3=0}digestInto(t){re(this),Ke(t,this),this.finished=!0;let{s0:r,s1:n,s2:o,s3:c}=this,i=J(t);return i[0]=r,i[1]=n,i[2]=o,i[3]=c,t}digest(){let t=new Uint8Array(Kt);return this.digestInto(t),this.destroy(),t}},Pn=class extends Sr{constructor(t,r){t=Ht(t);let n=Vc(t.slice());super(n,r),n.fill(0)}update(t){t=Ht(t),re(this);let r=J(t),n=t.length%Kt,o=Math.floor(t.length/Kt);for(let c=0;c<o;c++)this._updateBlock(Ut(r[c*4+3]),Ut(r[c*4+2]),Ut(r[c*4+1]),Ut(r[c*4+0]));return n&&(Rn.set(t.subarray(o*Kt)),this._updateBlock(Ut(Ct[3]),Ut(Ct[2]),Ut(Ct[1]),Ut(Ct[0])),Ct.fill(0)),this}digestInto(t){re(this),Ke(t,this),this.finished=!0;let{s0:r,s1:n,s2:o,s3:c}=this,i=J(t);return i[0]=r,i[1]=n,i[2]=o,i[3]=c,t.reverse()}};function es(e){let t=(n,o)=>e(o,n.length).update(Ht(n)).digest(),r=e(new Uint8Array(16),0);return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=(n,o)=>e(n,o),t}var Mn=es((e,t)=>new Sr(e,t)),rs=es((e,t)=>new Pn(e,t));var xt=16,Vn=4,Lr=new Uint8Array(xt),Kc=283;function zn(e){return e<<1^Kc&-(e>>7)}function ke(e,t){let r=0;for(;t>0;t>>=1)r^=e&-(t&1),e=zn(e);return r}var Dn=(()=>{let e=new Uint8Array(256);for(let r=0,n=1;r<256;r++,n^=zn(n))e[r]=n;let t=new Uint8Array(256);t[0]=99;for(let r=0;r<255;r++){let n=e[255-r];n|=n<<8,t[e[r]]=(n^n>>4^n>>5^n>>6^n>>7^99)&255}return t})(),jc=Dn.map((e,t)=>Dn.indexOf(t)),Zc=e=>e<<24|e>>>8,$n=e=>e<<8|e>>>24;function ns(e,t){if(e.length!==256)throw new Error("Wrong sbox length");let r=new Uint32Array(256).map((u,l)=>t(e[l])),n=r.map($n),o=n.map($n),c=o.map($n),i=new Uint32Array(256*256),s=new Uint32Array(256*256),a=new Uint16Array(256*256);for(let u=0;u<256;u++)for(let l=0;l<256;l++){let h=u*256+l;i[h]=r[u]^n[l],s[h]=o[u]^c[l],a[h]=e[u]<<8|e[l]}return{sbox:e,sbox2:a,T0:r,T1:n,T2:o,T3:c,T01:i,T23:s}}var Kn=ns(Dn,e=>ke(e,3)<<24|e<<16|e<<8|ke(e,2)),os=ns(jc,e=>ke(e,11)<<24|ke(e,13)<<16|ke(e,9)<<8|ke(e,14)),Wc=(()=>{let e=new Uint8Array(16);for(let t=0,r=1;t<16;t++,r=zn(r))e[t]=r;return e})();function se(e){F(e);let t=e.length;if(![16,24,32].includes(t))throw new Error(`aes: wrong key size: should be 16, 24 or 32, got: ${t}`);let{sbox2:r}=Kn,n=J(e),o=n.length,c=s=>qt(r,s,s,s,s),i=new Uint32Array(t+28);i.set(n);for(let s=o;s<i.length;s++){let a=i[s-1];s%o===0?a=c(Zc(a))^Wc[s/o-1]:o>6&&s%o===4&&(a=c(a)),i[s]=i[s-o]^a}return i}function ss(e){let t=se(e),r=t.slice(),n=t.length,{sbox2:o}=Kn,{T0:c,T1:i,T2:s,T3:a}=os;for(let u=0;u<n;u+=4)for(let l=0;l<4;l++)r[u+l]=t[n-u-4+l];t.fill(0);for(let u=4;u<n-4;u++){let l=r[u],h=qt(o,l,l,l,l);r[u]=c[h&255]^i[h>>>8&255]^s[h>>>16&255]^a[h>>>24]}return r}function oe(e,t,r,n,o,c){return e[r<<8&65280|n>>>8&255]^t[o>>>8&65280|c>>>24&255]}function qt(e,t,r,n,o){return e[t&255|r&65280]|e[n>>>16&255|o>>>16&65280]<<16}function Tt(e,t,r,n,o){let{sbox2:c,T01:i,T23:s}=Kn,a=0;t^=e[a++],r^=e[a++],n^=e[a++],o^=e[a++];let u=e.length/4-2;for(let x=0;x<u;x++){let p=e[a++]^oe(i,s,t,r,n,o),g=e[a++]^oe(i,s,r,n,o,t),v=e[a++]^oe(i,s,n,o,t,r),E=e[a++]^oe(i,s,o,t,r,n);t=p,r=g,n=v,o=E}let l=e[a++]^qt(c,t,r,n,o),h=e[a++]^qt(c,r,n,o,t),y=e[a++]^qt(c,n,o,t,r),w=e[a++]^qt(c,o,t,r,n);return{s0:l,s1:h,s2:y,s3:w}}function is(e,t,r,n,o){let{sbox2:c,T01:i,T23:s}=os,a=0;t^=e[a++],r^=e[a++],n^=e[a++],o^=e[a++];let u=e.length/4-2;for(let x=0;x<u;x++){let p=e[a++]^oe(i,s,t,o,n,r),g=e[a++]^oe(i,s,r,t,o,n),v=e[a++]^oe(i,s,n,r,t,o),E=e[a++]^oe(i,s,o,n,r,t);t=p,r=g,n=v,o=E}let l=e[a++]^qt(c,t,o,n,r),h=e[a++]^qt(c,r,t,o,n),y=e[a++]^qt(c,n,r,t,o),w=e[a++]^qt(c,o,n,r,t);return{s0:l,s1:h,s2:y,s3:w}}function Oe(e,t){if(!t)return new Uint8Array(e);if(F(t),t.length<e)throw new Error(`aes: wrong destination length, expected at least ${e}, got: ${t.length}`);return t}function Gc(e,t,r,n){F(t,xt),F(r);let o=r.length;n=Oe(o,n);let c=t,i=J(c),{s0:s,s1:a,s2:u,s3:l}=Tt(e,i[0],i[1],i[2],i[3]),h=J(r),y=J(n);for(let x=0;x+4<=h.length;x+=4){y[x+0]=h[x+0]^s,y[x+1]=h[x+1]^a,y[x+2]=h[x+2]^u,y[x+3]=h[x+3]^l;let p=1;for(let g=c.length-1;g>=0;g--)p=p+(c[g]&255)|0,c[g]=p&255,p>>>=8;({s0:s,s1:a,s2:u,s3:l}=Tt(e,i[0],i[1],i[2],i[3]))}let w=xt*Math.floor(h.length/Vn);if(w<o){let x=new Uint32Array([s,a,u,l]),p=Br(x);for(let g=w,v=0;g<o;g++,v++)n[g]=r[g]^p[v]}return n}function je(e,t,r,n,o){F(r,xt),F(n),o=Oe(n.length,o);let c=r,i=J(c),s=ne(c),a=J(n),u=J(o),l=t?0:12,h=n.length,y=s.getUint32(l,t),{s0:w,s1:x,s2:p,s3:g}=Tt(e,i[0],i[1],i[2],i[3]);for(let E=0;E+4<=a.length;E+=4)u[E+0]=a[E+0]^w,u[E+1]=a[E+1]^x,u[E+2]=a[E+2]^p,u[E+3]=a[E+3]^g,y=y+1>>>0,s.setUint32(l,y,t),{s0:w,s1:x,s2:p,s3:g}=Tt(e,i[0],i[1],i[2],i[3]);let v=xt*Math.floor(a.length/Vn);if(v<h){let E=new Uint32Array([w,x,p,g]),k=Br(E);for(let B=v,L=0;B<h;B++,L++)o[B]=n[B]^k[L]}return o}var Ru=Nt({blockSize:16,nonceLength:16},function(t,r){F(t),F(r,xt);function n(o,c){let i=se(t),s=r.slice(),a=Gc(i,s,o,c);return i.fill(0),s.fill(0),a}return{encrypt:(o,c)=>n(o,c),decrypt:(o,c)=>n(o,c)}});function cs(e){if(F(e),e.length%xt!==0)throw new Error(`aes/(cbc-ecb).decrypt ciphertext should consist of blocks with size ${xt}`)}function as(e,t,r){let n=e.length,o=n%xt;if(!t&&o!==0)throw new Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");let c=J(e);if(t){let a=xt-o;a||(a=xt),n=n+a}let i=Oe(n,r),s=J(i);return{b:c,o:s,out:i}}function fs(e,t){if(!t)return e;let r=e.length;if(!r)throw new Error("aes/pcks5: empty ciphertext not allowed");let n=e[r-1];if(n<=0||n>16)throw new Error(`aes/pcks5: wrong padding byte: ${n}`);let o=e.subarray(0,-n);for(let c=0;c<n;c++)if(e[r-c-1]!==n)throw new Error("aes/pcks5: wrong padding");return o}function us(e){let t=new Uint8Array(16),r=J(t);t.set(e);let n=xt-e.length;for(let o=xt-n;o<xt;o++)t[o]=n;return r}var Mu=Nt({blockSize:16},function(t,r={}){F(t);let n=!r.disablePadding;return{encrypt:(o,c)=>{F(o);let{b:i,o:s,out:a}=as(o,n,c),u=se(t),l=0;for(;l+4<=i.length;){let{s0:h,s1:y,s2:w,s3:x}=Tt(u,i[l+0],i[l+1],i[l+2],i[l+3]);s[l++]=h,s[l++]=y,s[l++]=w,s[l++]=x}if(n){let h=us(o.subarray(l*4)),{s0:y,s1:w,s2:x,s3:p}=Tt(u,h[0],h[1],h[2],h[3]);s[l++]=y,s[l++]=w,s[l++]=x,s[l++]=p}return u.fill(0),a},decrypt:(o,c)=>{cs(o);let i=ss(t),s=Oe(o.length,c),a=J(o),u=J(s);for(let l=0;l+4<=a.length;){let{s0:h,s1:y,s2:w,s3:x}=is(i,a[l+0],a[l+1],a[l+2],a[l+3]);u[l++]=h,u[l++]=y,u[l++]=w,u[l++]=x}return i.fill(0),fs(s,n)}}}),jn=Nt({blockSize:16,nonceLength:16},function(t,r,n={}){F(t),F(r,16);let o=!n.disablePadding;return{encrypt:(c,i)=>{let s=se(t),{b:a,o:u,out:l}=as(c,o,i),h=J(r),y=h[0],w=h[1],x=h[2],p=h[3],g=0;for(;g+4<=a.length;)y^=a[g+0],w^=a[g+1],x^=a[g+2],p^=a[g+3],{s0:y,s1:w,s2:x,s3:p}=Tt(s,y,w,x,p),u[g++]=y,u[g++]=w,u[g++]=x,u[g++]=p;if(o){let v=us(c.subarray(g*4));y^=v[0],w^=v[1],x^=v[2],p^=v[3],{s0:y,s1:w,s2:x,s3:p}=Tt(s,y,w,x,p),u[g++]=y,u[g++]=w,u[g++]=x,u[g++]=p}return s.fill(0),l},decrypt:(c,i)=>{cs(c);let s=ss(t),a=J(r),u=Oe(c.length,i),l=J(c),h=J(u),y=a[0],w=a[1],x=a[2],p=a[3];for(let g=0;g+4<=l.length;){let v=y,E=w,k=x,B=p;y=l[g+0],w=l[g+1],x=l[g+2],p=l[g+3];let{s0:L,s1:U,s2:H,s3:P}=is(s,y,w,x,p);h[g++]=L^v,h[g++]=U^E,h[g++]=H^k,h[g++]=P^B}return s.fill(0),fs(u,o)}}}),$u=Nt({blockSize:16,nonceLength:16},function(t,r){F(t),F(r,16);function n(o,c,i){let s=se(t),a=o.length;i=Oe(a,i);let u=J(o),l=J(i),h=c?l:u,y=J(r),w=y[0],x=y[1],p=y[2],g=y[3];for(let E=0;E+4<=u.length;){let{s0:k,s1:B,s2:L,s3:U}=Tt(s,w,x,p,g);l[E+0]=u[E+0]^k,l[E+1]=u[E+1]^B,l[E+2]=u[E+2]^L,l[E+3]=u[E+3]^U,w=h[E++],x=h[E++],p=h[E++],g=h[E++]}let v=xt*Math.floor(u.length/Vn);if(v<a){({s0:w,s1:x,s2:p,s3:g}=Tt(s,w,x,p,g));let E=Br(new Uint32Array([w,x,p,g]));for(let k=v,B=0;k<a;k++,B++)i[k]=o[k]^E[B];E.fill(0)}return s.fill(0),i}return{encrypt:(o,c)=>n(o,!0,c),decrypt:(o,c)=>n(o,!1,c)}});function ls(e,t,r,n,o){let c=e.create(r,n.length+(o?.length||0));o&&c.update(o),c.update(n);let i=new Uint8Array(16),s=ne(i);return o&&pe(s,0,BigInt(o.length*8),t),pe(s,8,BigInt(n.length*8),t),c.update(i),c.digest()}var Du=Nt({blockSize:16,nonceLength:12,tagLength:16},function(t,r,n){if(F(r),r.length===0)throw new Error("aes/gcm: empty nonce");let o=16;function c(s,a,u){let l=ls(Mn,!1,s,u,n);for(let h=0;h<a.length;h++)l[h]^=a[h];return l}function i(){let s=se(t),a=Lr.slice(),u=Lr.slice();if(je(s,!1,u,u,a),r.length===12)u.set(r);else{let h=Lr.slice(),y=ne(h);pe(y,8,BigInt(r.length*8),!1),Mn.create(a).update(r).update(h).digestInto(u)}let l=je(s,!1,u,Lr);return{xk:s,authKey:a,counter:u,tagMask:l}}return{encrypt:s=>{F(s);let{xk:a,authKey:u,counter:l,tagMask:h}=i(),y=new Uint8Array(s.length+o);je(a,!1,l,s,y);let w=c(u,h,y.subarray(0,y.length-o));return y.set(w,s.length),a.fill(0),y},decrypt:s=>{if(F(s),s.length<o)throw new Error(`aes/gcm: ciphertext less than tagLen (${o})`);let{xk:a,authKey:u,counter:l,tagMask:h}=i(),y=s.subarray(0,-o),w=s.subarray(-o),x=c(u,h,y);if(!de(x,w))throw new Error("aes/gcm: invalid ghash tag");let p=je(a,!1,l,y);return u.fill(0),h.fill(0),a.fill(0),p}}}),Ur=(e,t,r)=>n=>{if(!Number.isSafeInteger(n)||t>n||n>r)throw new Error(`${e}: invalid value=${n}, must be [${t}..${r}]`)},Vu=Nt({blockSize:16,nonceLength:12,tagLength:16},function(t,r,n){let c=Ur("AAD",0,68719476736),i=Ur("plaintext",0,2**36),s=Ur("nonce",12,12),a=Ur("ciphertext",16,2**36+16);F(r),s(r.length),n&&(F(n),c(n.length));function u(){let y=t.length;if(y!==16&&y!==24&&y!==32)throw new Error(`key length must be 16, 24 or 32 bytes, got: ${y} bytes`);let w=se(t),x=new Uint8Array(y),p=new Uint8Array(16),g=J(r),v=0,E=g[0],k=g[1],B=g[2],L=0;for(let U of[p,x].map(J)){let H=J(U);for(let P=0;P<H.length;P+=2){let{s0:z,s1:M}=Tt(w,v,E,k,B);H[P+0]=z,H[P+1]=M,v=++L}}return w.fill(0),{authKey:p,encKey:se(x)}}function l(y,w,x){let p=ls(rs,!0,w,x,n);for(let L=0;L<12;L++)p[L]^=r[L];p[15]&=127;let g=J(p),v=g[0],E=g[1],k=g[2],B=g[3];return{s0:v,s1:E,s2:k,s3:B}=Tt(y,v,E,k,B),g[0]=v,g[1]=E,g[2]=k,g[3]=B,p}function h(y,w,x){let p=w.slice();return p[15]|=128,je(y,!0,p,x)}return{encrypt:y=>{F(y),i(y.length);let{encKey:w,authKey:x}=u(),p=l(w,x,y),g=new Uint8Array(y.length+16);return g.set(p,y.length),g.set(h(w,p,y)),w.fill(0),x.fill(0),g},decrypt:y=>{F(y),a(y.length);let w=y.subarray(-16),{encKey:x,authKey:p}=u(),g=h(x,w,y.subarray(0,-16)),v=l(x,p,g);if(x.fill(0),p.fill(0),!de(w,v))throw new Error("invalid polyval tag");return g}}});var Yc=new TextDecoder("utf-8"),Xc=new TextEncoder;function hs(e,t,r){let n=e instanceof Uint8Array?gt(e):e,o=Ft.getSharedSecret(n,"02"+t),c=ps(o),i=Uint8Array.from(yr(16)),s=Xc.encode(r),a=jn(c,i).encrypt(s),u=zt.encode(new Uint8Array(a)),l=zt.encode(new Uint8Array(i.buffer));return`${u}?iv=${l}`}function ds(e,t,r){let n=e instanceof Uint8Array?gt(e):e,[o,c]=r.split("?iv="),i=Ft.getSharedSecret(n,"02"+t),s=ps(i),a=zt.decode(c),u=zt.decode(o),l=jn(s,a).decrypt(u);return Yc.decode(l)}function ps(e){return e.slice(1,33)}var pt=(e,t)=>e[t++]&255|(e[t++]&255)<<8,Zn=class{constructor(t){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,t=Ht(t),F(t,32);let r=pt(t,0),n=pt(t,2),o=pt(t,4),c=pt(t,6),i=pt(t,8),s=pt(t,10),a=pt(t,12),u=pt(t,14);this.r[0]=r&8191,this.r[1]=(r>>>13|n<<3)&8191,this.r[2]=(n>>>10|o<<6)&7939,this.r[3]=(o>>>7|c<<9)&8191,this.r[4]=(c>>>4|i<<12)&255,this.r[5]=i>>>1&8190,this.r[6]=(i>>>14|s<<2)&8191,this.r[7]=(s>>>11|a<<5)&8065,this.r[8]=(a>>>8|u<<8)&8191,this.r[9]=u>>>5&127;for(let l=0;l<8;l++)this.pad[l]=pt(t,16+2*l)}process(t,r,n=!1){let o=n?0:2048,{h:c,r:i}=this,s=i[0],a=i[1],u=i[2],l=i[3],h=i[4],y=i[5],w=i[6],x=i[7],p=i[8],g=i[9],v=pt(t,r+0),E=pt(t,r+2),k=pt(t,r+4),B=pt(t,r+6),L=pt(t,r+8),U=pt(t,r+10),H=pt(t,r+12),P=pt(t,r+14),z=c[0]+(v&8191),M=c[1]+((v>>>13|E<<3)&8191),N=c[2]+((E>>>10|k<<6)&8191),j=c[3]+((k>>>7|B<<9)&8191),D=c[4]+((B>>>4|L<<12)&8191),G=c[5]+(L>>>1&8191),T=c[6]+((L>>>14|U<<2)&8191),I=c[7]+((U>>>11|H<<5)&8191),R=c[8]+((H>>>8|P<<8)&8191),K=c[9]+(P>>>5|o),C=0,Z=C+z*s+M*(5*g)+N*(5*p)+j*(5*x)+D*(5*w);C=Z>>>13,Z&=8191,Z+=G*(5*y)+T*(5*h)+I*(5*l)+R*(5*u)+K*(5*a),C+=Z>>>13,Z&=8191;let Y=C+z*a+M*s+N*(5*g)+j*(5*p)+D*(5*x);C=Y>>>13,Y&=8191,Y+=G*(5*w)+T*(5*y)+I*(5*h)+R*(5*l)+K*(5*u),C+=Y>>>13,Y&=8191;let X=C+z*u+M*a+N*s+j*(5*g)+D*(5*p);C=X>>>13,X&=8191,X+=G*(5*x)+T*(5*w)+I*(5*y)+R*(5*h)+K*(5*l),C+=X>>>13,X&=8191;let nt=C+z*l+M*u+N*a+j*s+D*(5*g);C=nt>>>13,nt&=8191,nt+=G*(5*p)+T*(5*x)+I*(5*w)+R*(5*y)+K*(5*h),C+=nt>>>13,nt&=8191;let ft=C+z*h+M*l+N*u+j*a+D*s;C=ft>>>13,ft&=8191,ft+=G*(5*g)+T*(5*p)+I*(5*x)+R*(5*w)+K*(5*y),C+=ft>>>13,ft&=8191;let yt=C+z*y+M*h+N*l+j*u+D*a;C=yt>>>13,yt&=8191,yt+=G*s+T*(5*g)+I*(5*p)+R*(5*x)+K*(5*w),C+=yt>>>13,yt&=8191;let lt=C+z*w+M*y+N*h+j*l+D*u;C=lt>>>13,lt&=8191,lt+=G*a+T*s+I*(5*g)+R*(5*p)+K*(5*x),C+=lt>>>13,lt&=8191;let ut=C+z*x+M*w+N*y+j*h+D*l;C=ut>>>13,ut&=8191,ut+=G*u+T*a+I*s+R*(5*g)+K*(5*p),C+=ut>>>13,ut&=8191;let At=C+z*p+M*x+N*w+j*y+D*h;C=At>>>13,At&=8191,At+=G*l+T*u+I*a+R*s+K*(5*g),C+=At>>>13,At&=8191;let ht=C+z*g+M*p+N*x+j*w+D*y;C=ht>>>13,ht&=8191,ht+=G*h+T*l+I*u+R*a+K*s,C+=ht>>>13,ht&=8191,C=(C<<2)+C|0,C=C+Z|0,Z=C&8191,C=C>>>13,Y+=C,c[0]=Z,c[1]=Y,c[2]=X,c[3]=nt,c[4]=ft,c[5]=yt,c[6]=lt,c[7]=ut,c[8]=At,c[9]=ht}finalize(){let{h:t,pad:r}=this,n=new Uint16Array(10),o=t[1]>>>13;t[1]&=8191;for(let s=2;s<10;s++)t[s]+=o,o=t[s]>>>13,t[s]&=8191;t[0]+=o*5,o=t[0]>>>13,t[0]&=8191,t[1]+=o,o=t[1]>>>13,t[1]&=8191,t[2]+=o,n[0]=t[0]+5,o=n[0]>>>13,n[0]&=8191;for(let s=1;s<10;s++)n[s]=t[s]+o,o=n[s]>>>13,n[s]&=8191;n[9]-=8192;let c=(o^1)-1;for(let s=0;s<10;s++)n[s]&=c;c=~c;for(let s=0;s<10;s++)t[s]=t[s]&c|n[s];t[0]=(t[0]|t[1]<<13)&65535,t[1]=(t[1]>>>3|t[2]<<10)&65535,t[2]=(t[2]>>>6|t[3]<<7)&65535,t[3]=(t[3]>>>9|t[4]<<4)&65535,t[4]=(t[4]>>>12|t[5]<<1|t[6]<<14)&65535,t[5]=(t[6]>>>2|t[7]<<11)&65535,t[6]=(t[7]>>>5|t[8]<<8)&65535,t[7]=(t[8]>>>8|t[9]<<5)&65535;let i=t[0]+r[0];t[0]=i&65535;for(let s=1;s<8;s++)i=(t[s]+r[s]|0)+(i>>>16)|0,t[s]=i&65535}update(t){re(this);let{buffer:r,blockLen:n}=this;t=Ht(t);let o=t.length;for(let c=0;c<o;){let i=Math.min(n-this.pos,o-c);if(i===n){for(;n<=o-c;c+=n)this.process(t,c);continue}r.set(t.subarray(c,c+i),this.pos),this.pos+=i,c+=i,this.pos===n&&(this.process(r,0,!1),this.pos=0)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto(t){re(this),Ke(t,this),this.finished=!0;let{buffer:r,h:n}=this,{pos:o}=this;if(o){for(r[o++]=1;o<16;o++)r[o]=0;this.process(r,0,!0)}this.finalize();let c=0;for(let i=0;i<8;i++)t[c++]=n[i]>>>0,t[c++]=n[i]>>>8;return t}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}};function Jc(e){let t=(n,o)=>e(o).update(Ht(n)).digest(),r=e(new Uint8Array(32));return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=n=>e(n),t}var gs=Jc(e=>new Zn(e));var xs=e=>Uint8Array.from(e.split("").map(t=>t.charCodeAt(0))),Qc=xs("expand 16-byte k"),ta=xs("expand 32-byte k"),ea=J(Qc),ms=J(ta),rl=ms.slice();function $(e,t){return e<<t|e>>>32-t}function Wn(e){return e.byteOffset%4===0}var Tr=64,ra=16,ws=2**32-1,ys=new Uint32Array;function na(e,t,r,n,o,c,i,s){let a=o.length,u=new Uint8Array(Tr),l=J(u),h=Wn(o)&&Wn(c),y=h?J(o):ys,w=h?J(c):ys;for(let x=0;x<a;i++){if(e(t,r,n,l,i,s),i>=ws)throw new Error("arx: counter overflow");let p=Math.min(Tr,a-x);if(h&&p===Tr){let g=x/4;if(x%4!==0)throw new Error("arx: invalid block position");for(let v=0,E;v<ra;v++)E=g+v,w[E]=y[E]^l[v];x+=Tr;continue}for(let g=0,v;g<p;g++)v=x+g,c[v]=o[v]^u[g];x+=p}}function Gn(e,t){let{allowShortKeys:r,extendNonceFn:n,counterLength:o,counterRight:c,rounds:i}=ts({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if(typeof e!="function")throw new Error("core must be a function");return Er(o),Er(i),Cn(c),Cn(r),(s,a,u,l,h=0)=>{F(s),F(a),F(u);let y=u.length;if(l||(l=new Uint8Array(y)),F(l),Er(h),h<0||h>=ws)throw new Error("arx: counter overflow");if(l.length<y)throw new Error(`arx: output (${l.length}) is shorter than data (${y})`);let w=[],x=s.length,p,g;if(x===32)p=s.slice(),w.push(p),g=ms;else if(x===16&&r)p=new Uint8Array(32),p.set(s),p.set(s,16),g=ea,w.push(p);else throw new Error(`arx: invalid 32-byte key, got length=${x}`);Wn(a)||(a=a.slice(),w.push(a));let v=J(p);if(n){if(a.length!==24)throw new Error("arx: extended nonce must be 24 bytes");n(g,v,J(a.subarray(0,16)),v),a=a.subarray(16)}let E=16-o;if(E!==a.length)throw new Error(`arx: nonce must be ${E} or 16 bytes`);if(E!==12){let B=new Uint8Array(12);B.set(a,c?0:12-a.length),a=B,w.push(a)}let k=J(a);for(na(e,g,v,k,u,l,h,i);w.length>0;)w.pop().fill(0);return l}}function vs(e,t,r,n,o,c=20){let i=e[0],s=e[1],a=e[2],u=e[3],l=t[0],h=t[1],y=t[2],w=t[3],x=t[4],p=t[5],g=t[6],v=t[7],E=o,k=r[0],B=r[1],L=r[2],U=i,H=s,P=a,z=u,M=l,N=h,j=y,D=w,G=x,T=p,I=g,R=v,K=E,C=k,Z=B,Y=L;for(let nt=0;nt<c;nt+=2)U=U+M|0,K=$(K^U,16),G=G+K|0,M=$(M^G,12),U=U+M|0,K=$(K^U,8),G=G+K|0,M=$(M^G,7),H=H+N|0,C=$(C^H,16),T=T+C|0,N=$(N^T,12),H=H+N|0,C=$(C^H,8),T=T+C|0,N=$(N^T,7),P=P+j|0,Z=$(Z^P,16),I=I+Z|0,j=$(j^I,12),P=P+j|0,Z=$(Z^P,8),I=I+Z|0,j=$(j^I,7),z=z+D|0,Y=$(Y^z,16),R=R+Y|0,D=$(D^R,12),z=z+D|0,Y=$(Y^z,8),R=R+Y|0,D=$(D^R,7),U=U+N|0,Y=$(Y^U,16),I=I+Y|0,N=$(N^I,12),U=U+N|0,Y=$(Y^U,8),I=I+Y|0,N=$(N^I,7),H=H+j|0,K=$(K^H,16),R=R+K|0,j=$(j^R,12),H=H+j|0,K=$(K^H,8),R=R+K|0,j=$(j^R,7),P=P+D|0,C=$(C^P,16),G=G+C|0,D=$(D^G,12),P=P+D|0,C=$(C^P,8),G=G+C|0,D=$(D^G,7),z=z+M|0,Z=$(Z^z,16),T=T+Z|0,M=$(M^T,12),z=z+M|0,Z=$(Z^z,8),T=T+Z|0,M=$(M^T,7);let X=0;n[X++]=i+U|0,n[X++]=s+H|0,n[X++]=a+P|0,n[X++]=u+z|0,n[X++]=l+M|0,n[X++]=h+N|0,n[X++]=y+j|0,n[X++]=w+D|0,n[X++]=x+G|0,n[X++]=p+T|0,n[X++]=g+I|0,n[X++]=v+R|0,n[X++]=E+K|0,n[X++]=k+C|0,n[X++]=B+Z|0,n[X++]=L+Y|0}function oa(e,t,r,n){let o=e[0],c=e[1],i=e[2],s=e[3],a=t[0],u=t[1],l=t[2],h=t[3],y=t[4],w=t[5],x=t[6],p=t[7],g=r[0],v=r[1],E=r[2],k=r[3];for(let L=0;L<20;L+=2)o=o+a|0,g=$(g^o,16),y=y+g|0,a=$(a^y,12),o=o+a|0,g=$(g^o,8),y=y+g|0,a=$(a^y,7),c=c+u|0,v=$(v^c,16),w=w+v|0,u=$(u^w,12),c=c+u|0,v=$(v^c,8),w=w+v|0,u=$(u^w,7),i=i+l|0,E=$(E^i,16),x=x+E|0,l=$(l^x,12),i=i+l|0,E=$(E^i,8),x=x+E|0,l=$(l^x,7),s=s+h|0,k=$(k^s,16),p=p+k|0,h=$(h^p,12),s=s+h|0,k=$(k^s,8),p=p+k|0,h=$(h^p,7),o=o+u|0,k=$(k^o,16),x=x+k|0,u=$(u^x,12),o=o+u|0,k=$(k^o,8),x=x+k|0,u=$(u^x,7),c=c+l|0,g=$(g^c,16),p=p+g|0,l=$(l^p,12),c=c+l|0,g=$(g^c,8),p=p+g|0,l=$(l^p,7),i=i+h|0,v=$(v^i,16),y=y+v|0,h=$(h^y,12),i=i+h|0,v=$(v^i,8),y=y+v|0,h=$(h^y,7),s=s+a|0,E=$(E^s,16),w=w+E|0,a=$(a^w,12),s=s+a|0,E=$(E^s,8),w=w+E|0,a=$(a^w,7);let B=0;n[B++]=o,n[B++]=c,n[B++]=i,n[B++]=s,n[B++]=g,n[B++]=v,n[B++]=E,n[B++]=k}var Ir=Gn(vs,{counterRight:!1,counterLength:4,allowShortKeys:!1}),sa=Gn(vs,{counterRight:!1,counterLength:8,extendNonceFn:oa,allowShortKeys:!1});var ia=new Uint8Array(16),bs=(e,t)=>{e.update(t);let r=t.length%16;r&&e.update(ia.subarray(r))},ca=new Uint8Array(32);function As(e,t,r,n,o){let c=e(t,r,ca),i=gs.create(c);o&&bs(i,o),bs(i,n);let s=new Uint8Array(16),a=ne(s);pe(a,0,BigInt(o?o.length:0),!0),pe(a,8,BigInt(n.length),!0),i.update(s);let u=i.digest();return c.fill(0),u}var Es=e=>(t,r,n)=>(F(t,32),F(r),{encrypt:(c,i)=>{let s=c.length,a=s+16;i?F(i,a):i=new Uint8Array(a),e(t,r,c,i,1);let u=As(e,t,r,i.subarray(0,-16),n);return i.set(u,s),i},decrypt:(c,i)=>{let s=c.length,a=s-16;if(s<16)throw new Error("encrypted data must be at least 16 bytes");i?F(i,a):i=new Uint8Array(a);let u=c.subarray(0,-16),l=c.subarray(-16),h=As(e,t,r,u,n);if(!de(l,h))throw new Error("invalid tag");return e(t,r,u,i,1),i}}),al=Nt({blockSize:64,nonceLength:12,tagLength:16},Es(Ir)),fl=Nt({blockSize:64,nonceLength:24,tagLength:16},Es(sa));var _r=class extends Ue{constructor(t,r){super(),this.finished=!1,this.destroyed=!1,Bt.hash(t);let n=Jt(r);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let o=this.blockLen,c=new Uint8Array(o);c.set(n.length>o?t.create().update(n).digest():n);for(let i=0;i<c.length;i++)c[i]^=54;this.iHash.update(c),this.oHash=t.create();for(let i=0;i<c.length;i++)c[i]^=106;this.oHash.update(c),c.fill(0)}update(t){return Bt.exists(this),this.iHash.update(t),this}digestInto(t){Bt.exists(this),Bt.bytes(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:o,destroyed:c,blockLen:i,outputLen:s}=this;return t=t,t.finished=o,t.destroyed=c,t.blockLen=i,t.outputLen=s,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},He=(e,t,r)=>new _r(e,t).update(r).digest();He.create=(e,t)=>new _r(e,t);function Ss(e,t,r){return Bt.hash(e),r===void 0&&(r=new Uint8Array(e.outputLen)),He(e,Jt(r),Jt(t))}var Yn=new Uint8Array([0]),Bs=new Uint8Array;function Ls(e,t,r,n=32){if(Bt.hash(e),Bt.number(n),n>255*e.outputLen)throw new Error("Length should be <= 255*HashLen");let o=Math.ceil(n/e.outputLen);r===void 0&&(r=Bs);let c=new Uint8Array(o*e.outputLen),i=He.create(e,t),s=i._cloneInto(),a=new Uint8Array(i.outputLen);for(let u=0;u<o;u++)Yn[0]=u+1,s.update(u===0?Bs:a).update(r).update(Yn).digestInto(a),c.set(a,e.outputLen*u),i._cloneInto(s);return i.destroy(),s.destroy(),a.fill(0),Yn.fill(0),c.slice(0,n)}var aa=new TextDecoder("utf-8"),fa=new TextEncoder,Us=1,Ts=65535;function ua(e,t){let r=Ft.getSharedSecret(e,"02"+t).subarray(1,33);return Ss(Te,r,"nip44-v2")}function Is(e,t){let r=Ls(Te,e,t,76);return{chacha_key:r.subarray(0,32),chacha_nonce:r.subarray(32,44),hmac_key:r.subarray(44,76)}}function Xn(e){if(!Number.isSafeInteger(e)||e<1)throw new Error("expected positive integer");if(e<=32)return 32;let t=1<<Math.floor(Math.log2(e-1))+1,r=t<=256?32:t/8;return r*(Math.floor((e-1)/r)+1)}function la(e){if(!Number.isSafeInteger(e)||e<Us||e>Ts)throw new Error("invalid plaintext size: must be between 1 and 65535 bytes");let t=new Uint8Array(2);return new DataView(t.buffer).setUint16(0,e,!1),t}function ha(e){let t=fa.encode(e),r=t.length,n=la(r),o=new Uint8Array(Xn(r)-r);return Ve(n,t,o)}function da(e){let t=new DataView(e.buffer).getUint16(0),r=e.subarray(2,2+t);if(t<Us||t>Ts||r.length!==t||e.length!==2+Xn(t))throw new Error("invalid padding");return aa.decode(r)}function _s(e,t,r){if(r.length!==32)throw new Error("AAD associated data must be 32 bytes");let n=Ve(r,t);return He(Te,e,n)}function pa(e){if(typeof e!="string")throw new Error("payload must be a valid string");let t=e.length;if(t<132||t>87472)throw new Error("invalid payload length: "+t);if(e[0]==="#")throw new Error("unknown encryption version");let r;try{r=zt.decode(e)}catch(c){throw new Error("invalid base64: "+c.message)}let n=r.length;if(n<99||n>65603)throw new Error("invalid data length: "+n);let o=r[0];if(o!==2)throw new Error("unknown encryption version "+o);return{nonce:r.subarray(1,33),ciphertext:r.subarray(33,-32),mac:r.subarray(-32)}}function ga(e,t,r=yr(32)){let{chacha_key:n,chacha_nonce:o,hmac_key:c}=Is(t,r),i=ha(e),s=Ir(n,o,i),a=_s(c,s,r);return zt.encode(Ve(new Uint8Array([2]),r,s,a))}function ya(e,t){let{nonce:r,ciphertext:n,mac:o}=pa(e),{chacha_key:c,chacha_nonce:i,hmac_key:s}=Is(t,r),a=_s(s,n,r);if(!de(a,o))throw new Error("invalid MAC");let u=Ir(c,i,n);return da(u)}var kr={utils:{getConversationKey:ua,calcPaddedLen:Xn},encrypt:ga,decrypt:ya};var Il=new Error("timeout while waiting for mutex to become available"),_l=new Error("mutex already locked"),ma=new Error("request for lock canceled"),ks=function(e,t,r,n){function o(c){return c instanceof r?c:new r(function(i){i(c)})}return new(r||(r=Promise))(function(c,i){function s(l){try{u(n.next(l))}catch(h){i(h)}}function a(l){try{u(n.throw(l))}catch(h){i(h)}}function u(l){l.done?c(l.value):o(l.value).then(s,a)}u((n=n.apply(e,t||[])).next())})},Fn=class{constructor(t,r=ma){if(this._maxConcurrency=t,this._cancelError=r,this._queue=[],this._waiters=[],t<=0)throw new Error("semaphore must be initialized to a positive value");this._value=t}acquire(){let t=this.isLocked(),r=new Promise((n,o)=>this._queue.push({resolve:n,reject:o}));return t||this._dispatch(),r}runExclusive(t){return ks(this,void 0,void 0,function*(){let[r,n]=yield this.acquire();try{return yield t(r)}finally{n()}})}waitForUnlock(){return ks(this,void 0,void 0,function*(){return this.isLocked()?new Promise(r=>this._waiters.push({resolve:r})):Promise.resolve()})}isLocked(){return this._value<=0}release(){if(this._maxConcurrency>1)throw new Error("this method is unavailable on semaphores with concurrency > 1; use the scoped release returned by acquire instead");if(this._currentReleaser){let t=this._currentReleaser;this._currentReleaser=void 0,t()}}cancel(){this._queue.forEach(t=>t.reject(this._cancelError)),this._queue=[]}_dispatch(){let t=this._queue.shift();if(!t)return;let r=!1;this._currentReleaser=()=>{r||(r=!0,this._value++,this._resolveWaiters(),this._dispatch())},t.resolve([this._value--,this._currentReleaser])}_resolveWaiters(){this._waiters.forEach(t=>t.resolve()),this._waiters=[]}},wa=function(e,t,r,n){function o(c){return c instanceof r?c:new r(function(i){i(c)})}return new(r||(r=Promise))(function(c,i){function s(l){try{u(n.next(l))}catch(h){i(h)}}function a(l){try{u(n.throw(l))}catch(h){i(h)}}function u(l){l.done?c(l.value):o(l.value).then(s,a)}u((n=n.apply(e,t||[])).next())})},Or=class{constructor(t){this._semaphore=new Fn(1,t)}acquire(){return wa(this,void 0,void 0,function*(){let[,t]=yield this._semaphore.acquire();return t})}runExclusive(t){return this._semaphore.runExclusive(()=>t())}isLocked(){return this._semaphore.isLocked()}waitForUnlock(){return this._semaphore.waitForUnlock()}release(){this._semaphore.release()}cancel(){return this._semaphore.cancel()}};var Hr=class{constructor(t){this.maxSize=t,this.map=new Map,this.keys=[]}clear(){this.map.clear()}has(t){return this.map.has(t)}get(t){let r=this.map.get(t);return r!==void 0&&(this.keys.push(t),this.keys.length>this.maxSize*2&&this.keys.splice(-this.maxSize)),r}set(t,r){this.map.set(t,r),this.keys.push(t),this.map.size>this.maxSize&&this.map.delete(this.keys.shift())}};var ge=tn(rn()),Os={replaceURL:!0},Hl=Object.fromEntries([["getPublicKey","read your public key"],["signEvent","sign events using your private key"],["nip04.encrypt","encrypt messages to peers"],["nip04.decrypt","decrypt messages from peers"],["nip44.encrypt","encrypt messages to peers"],["nip44.decrypt","decrypt messages from peers"]]);function ba(e,t){return e?.kinds?t.kind in e.kinds:!0}async function Hs(e,t,r){let{policies:n}=await ge.default.storage.local.get("policies"),o=[!0,!1];for(let c=0;c<o.length;c++){let i=o[c],{conditions:s}=n?.[e]?.[i]?.[t]||{};if(s)if(t==="signEvent"){if(ba(s,r))return i;continue}else return i}}async function Ns(e,t,r,n){let{policies:o={}}=await ge.default.storage.local.get("policies");if(Object.keys(n).length===0)n={};else{let s=o[e]?.[r]?.[t]?.conditions;s&&s.kinds&&n.kinds&&Object.keys(s.kinds).forEach(a=>{n.kinds[a]=!0})}let c=!r,i=o?.[e]?.[c]?.[t];i&&JSON.stringify(i.conditions)===JSON.stringify(n)&&delete o[e][c][t],o[e]=o[e]||{},o[e][r]=o[e][r]||{},o[e][r][t]={conditions:n,created_at:Math.round(Date.now()/1e3)},ge.default.storage.local.set({policies:o})}async function Jn(e,t,r,n){let{notifications:o}=await ge.default.storage.local.get("notifications");if(o){let c=t?"allowed":"denied";ge.default.notifications.create(void 0,{type:"basic",title:`${r} ${c} for ${e}`,message:JSON.stringify(n?.event?{kind:n.event.kind,content:n.event.content,tags:n.event.tags}:n,null,2),iconUrl:"icons/48x48.png"})}}async function Qn(e,t){let r=0,n=0;try{let o=await ge.default.windows.getLastFocused();o&&o.top!==void 0&&o.left!==void 0&&o.width!==void 0&&o.height!==void 0?(n=Math.round(o.top+(o.height-t)/2),r=Math.round(o.left+(o.width-e)/2)):console.error("Last focused window properties are undefined.")}catch(o){console.error("Error getting window position:",o)}return{top:n,left:r}}var Aa={p:0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2fn,n:0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141n,h:1n,a:0n,b:7n,Gx:0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798n,Gy:0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8n},{p:xe,n:no,Gx:va,Gy:Ea,b:Ds}=Aa,Ne=32,to=64,wt=(e="")=>{throw new Error(e)},Vs=e=>typeof e=="bigint",zs=e=>typeof e=="string",Ba=e=>e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array",Ze=(e,t)=>!Ba(e)||typeof t=="number"&&t>0&&e.length!==t?wt("Uint8Array expected"):e,Mr=e=>new Uint8Array(e),Sa=e=>Uint8Array.from(e),Ks=(e,t)=>e.toString(16).padStart(t,"0"),oo=e=>Array.from(Ze(e)).map(t=>Ks(t,2)).join(""),jt={_0:48,_9:57,A:65,F:70,a:97,f:102},Cs=e=>{if(e>=jt._0&&e<=jt._9)return e-jt._0;if(e>=jt.A&&e<=jt.F)return e-(jt.A-10);if(e>=jt.a&&e<=jt.f)return e-(jt.a-10)},so=e=>{let t="hex invalid";if(!zs(e))return wt(t);let r=e.length,n=r/2;if(r%2)return wt(t);let o=Mr(n);for(let c=0,i=0;c<n;c++,i+=2){let s=Cs(e.charCodeAt(i)),a=Cs(e.charCodeAt(i+1));if(s===void 0||a===void 0)return wt(t);o[c]=s*16+a}return o},io=(e,t)=>Ze(zs(e)?so(e):Sa(Ze(e)),t),js=()=>globalThis?.crypto,La=()=>js()?.subtle??wt("crypto.subtle must be defined"),Cr=(...e)=>{let t=Mr(e.reduce((n,o)=>n+Ze(o).length,0)),r=0;return e.forEach(n=>{t.set(n,r),r+=n.length}),t},Ua=(e=Ne)=>js().getRandomValues(Mr(e)),qr=BigInt,We=(e,t,r,n="bad number: out of range")=>Vs(e)&&t<=e&&e<r?e:wt(n),V=(e,t=xe)=>{let r=e%t;return r>=0n?r:t+r};var Zs=(e,t)=>{(e===0n||t<=0n)&&wt("no inverse n="+e+" mod="+t);let r=V(e,t),n=t,o=0n,c=1n,i=1n,s=0n;for(;r!==0n;){let a=n/r,u=n%r,l=o-i*a,h=c-s*a;n=r,r=u,o=i,c=s,i=l,s=h}return n===1n?V(o,t):wt("no inverse")};var qs=e=>e instanceof me?e:wt("Point expected"),Ws=e=>V(V(e*e)*e+Ds),Ps=e=>We(e,0n,xe),Nr=e=>We(e,1n,xe),Ta=e=>We(e,1n,no),eo=e=>(e&1n)===0n,Gs=e=>Uint8Array.of(e),Ia=e=>Gs(eo(e)?2:3),_a=e=>{let t=Ws(Nr(e)),r=1n;for(let n=t,o=(xe+1n)/4n;o>0n;o>>=1n)o&1n&&(r=r*n%xe),n=n*n%xe;return V(r*r)===t?r:wt("sqrt invalid")},me=class e{static BASE;static ZERO;px;py;pz;constructor(t,r,n){this.px=Ps(t),this.py=Nr(r),this.pz=Ps(n),Object.freeze(this)}static fromBytes(t){Ze(t);let r,n=t[0],o=t.subarray(1),c=Rs(o,0,Ne),i=t.length;if(i===Ne+1&&[2,3].includes(n)){let s=_a(c),a=eo(s);eo(qr(n))!==a&&(s=V(-s)),r=new e(c,s,1n)}return i===to+1&&n===4&&(r=new e(c,Rs(o,Ne,to),1n)),r?r.assertValidity():wt("bad point: not on curve")}equals(t){let{px:r,py:n,pz:o}=this,{px:c,py:i,pz:s}=qs(t),a=V(r*s),u=V(c*o),l=V(n*s),h=V(i*o);return a===u&&l===h}is0(){return this.equals(ye)}negate(){return new e(this.px,V(-this.py),this.pz)}double(){return this.add(this)}add(t){let{px:r,py:n,pz:o}=this,{px:c,py:i,pz:s}=qs(t),a=0n,u=Ds,l=0n,h=0n,y=0n,w=V(u*3n),x=V(r*c),p=V(n*i),g=V(o*s),v=V(r+n),E=V(c+i);v=V(v*E),E=V(x+p),v=V(v-E),E=V(r+o);let k=V(c+s);return E=V(E*k),k=V(x+g),E=V(E-k),k=V(n+o),l=V(i+s),k=V(k*l),l=V(p+g),k=V(k-l),y=V(a*E),l=V(w*g),y=V(l+y),l=V(p-y),y=V(p+y),h=V(l*y),p=V(x+x),p=V(p+x),g=V(a*g),E=V(w*E),p=V(p+g),g=V(x-g),g=V(a*g),E=V(E+g),x=V(p*E),h=V(h+x),x=V(k*E),l=V(v*l),l=V(l-x),x=V(v*p),y=V(k*y),y=V(y+x),new e(l,h,y)}multiply(t,r=!0){if(!r&&t===0n)return ye;if(Ta(t),t===1n)return this;if(this.equals(Ce))return Pa(t).p;let n=ye,o=Ce;for(let c=this;t>0n;c=c.double(),t>>=1n)t&1n?n=n.add(c):r&&(o=o.add(c));return n}toAffine(){let{px:t,py:r,pz:n}=this;if(this.equals(ye))return{x:0n,y:0n};if(n===1n)return{x:t,y:r};let o=Zs(n,xe);return V(n*o)!==1n&&wt("inverse invalid"),{x:V(t*o),y:V(r*o)}}assertValidity(){let{x:t,y:r}=this.toAffine();return Nr(t),Nr(r),V(r*r)===Ws(t)?this:wt("bad point: not on curve")}toBytes(t=!0){let{x:r,y:n}=this.assertValidity().toAffine(),o=Pr(r);return t?Cr(Ia(n),o):Cr(Gs(4),o,Pr(n))}static fromAffine(t){let{x:r,y:n}=t;return r===0n&&n===0n?ye:new e(r,n,1n)}toHex(t){return oo(this.toBytes(t))}static fromPrivateKey(t){return Ce.multiply(Oa(t))}static fromHex(t){return e.fromBytes(io(t))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}toRawBytes(t){return this.toBytes(t)}},Ce=new me(va,Ea,1n),ye=new me(0n,1n,0n);me.BASE=Ce;me.ZERO=ye;var $r=e=>qr("0x"+(oo(e)||"0")),Rs=(e,t,r)=>$r(e.subarray(t,r)),ka=2n**256n,Pr=e=>so(Ks(We(e,0n,ka),to)),Oa=e=>{let t=Vs(e)?e:$r(io(e,Ne));return We(t,1n,no,"private key invalid 3")};var Ha=e=>{e=io(e),(e.length<Ne+8||e.length>1024)&&wt("expected 40-1024b");let t=V($r(e),no-1n);return Pr(t+1n)};var Na="SHA-256",co={hexToBytes:so,bytesToHex:oo,concatBytes:Cr,bytesToNumberBE:$r,numberToBytesBE:Pr,mod:V,invert:Zs,hmacSha256Async:async(e,...t)=>{let r=La(),n="HMAC",o=await r.importKey("raw",e,{name:n,hash:{name:Na}},!1,["sign"]);return Mr(await r.sign(n,o,Cr(...t)))},hmacSha256Sync:void 0,hashToPrivateKey:Ha,randomBytes:Ua};var Rr=8,Ca=256,Ys=Math.ceil(Ca/Rr)+1,ro=2**(Rr-1),qa=()=>{let e=[],t=Ce,r=t;for(let n=0;n<Ys;n++){r=t,e.push(r);for(let o=1;o<ro;o++)r=r.add(t),e.push(r);t=r.double()}return e},Ms,$s=(e,t)=>{let r=t.negate();return e?r:t},Pa=e=>{let t=Ms||(Ms=qa()),r=ye,n=Ce,o=2**Rr,c=o,i=qr(o-1),s=qr(Rr);for(let a=0;a<Ys;a++){let u=Number(e&i);e>>=s,u>ro&&(u-=c,e+=1n);let l=a*ro,h=l,y=l+Math.abs(u)-1,w=a%2!==0,x=u<0;u===0?n=n.add($s(w,t[h])):r=r.add($s(x,t[y]))}return{p:r,f:n}};function Ma(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Xs(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function Pe(e,...t){if(!Ma(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function Fs(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");Xs(e.outputLen),Xs(e.blockLen)}function Re(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Js(e,t){Pe(e);let r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function we(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function Dr(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Ot(e,t){return e<<32-t|e>>>t}function $a(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function Ge(e){return typeof e=="string"&&(e=$a(e)),Pe(e),e}var qe=class{};function Qs(e){let t=n=>e().update(Ge(n)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}var Vr=class extends qe{constructor(t,r){super(),this.finished=!1,this.destroyed=!1,Fs(t);let n=Ge(r);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let o=this.blockLen,c=new Uint8Array(o);c.set(n.length>o?t.create().update(n).digest():n);for(let i=0;i<c.length;i++)c[i]^=54;this.iHash.update(c),this.oHash=t.create();for(let i=0;i<c.length;i++)c[i]^=106;this.oHash.update(c),we(c)}update(t){return Re(this),this.iHash.update(t),this}digestInto(t){Re(this),Pe(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:o,destroyed:c,blockLen:i,outputLen:s}=this;return t=t,t.finished=o,t.destroyed=c,t.blockLen=i,t.outputLen=s,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},ao=(e,t,r)=>new Vr(e,t).update(r).digest();ao.create=(e,t)=>new Vr(e,t);function Da(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);let o=BigInt(32),c=BigInt(4294967295),i=Number(r>>o&c),s=Number(r&c),a=n?4:0,u=n?0:4;e.setUint32(t+a,i,n),e.setUint32(t+u,s,n)}function ti(e,t,r){return e&t^~e&r}function ei(e,t,r){return e&t^e&r^t&r}var zr=class extends qe{constructor(t,r,n,o){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=o,this.buffer=new Uint8Array(t),this.view=Dr(this.buffer)}update(t){Re(this),t=Ge(t),Pe(t);let{view:r,buffer:n,blockLen:o}=this,c=t.length;for(let i=0;i<c;){let s=Math.min(o-this.pos,c-i);if(s===o){let a=Dr(t);for(;o<=c-i;i+=o)this.process(a,i);continue}n.set(t.subarray(i,i+s),this.pos),this.pos+=s,i+=s,this.pos===o&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){Re(this),Js(t,this),this.finished=!0;let{buffer:r,view:n,blockLen:o,isLE:c}=this,{pos:i}=this;r[i++]=128,we(this.buffer.subarray(i)),this.padOffset>o-i&&(this.process(n,0),i=0);for(let h=i;h<o;h++)r[h]=0;Da(n,o-8,BigInt(this.length*8),c),this.process(n,0);let s=Dr(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let u=a/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<u;h++)s.setUint32(4*h,l[h],c)}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:r,buffer:n,length:o,finished:c,destroyed:i,pos:s}=this;return t.destroyed=i,t.finished=c,t.length=o,t.pos=s,o%r&&t.buffer.set(n),t}clone(){return this._cloneInto()}},Zt=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]);var Va=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ie=new Uint32Array(64),fo=class extends zr{constructor(t=32){super(64,t,8,!1),this.A=Zt[0]|0,this.B=Zt[1]|0,this.C=Zt[2]|0,this.D=Zt[3]|0,this.E=Zt[4]|0,this.F=Zt[5]|0,this.G=Zt[6]|0,this.H=Zt[7]|0}get(){let{A:t,B:r,C:n,D:o,E:c,F:i,G:s,H:a}=this;return[t,r,n,o,c,i,s,a]}set(t,r,n,o,c,i,s,a){this.A=t|0,this.B=r|0,this.C=n|0,this.D=o|0,this.E=c|0,this.F=i|0,this.G=s|0,this.H=a|0}process(t,r){for(let h=0;h<16;h++,r+=4)ie[h]=t.getUint32(r,!1);for(let h=16;h<64;h++){let y=ie[h-15],w=ie[h-2],x=Ot(y,7)^Ot(y,18)^y>>>3,p=Ot(w,17)^Ot(w,19)^w>>>10;ie[h]=p+ie[h-7]+x+ie[h-16]|0}let{A:n,B:o,C:c,D:i,E:s,F:a,G:u,H:l}=this;for(let h=0;h<64;h++){let y=Ot(s,6)^Ot(s,11)^Ot(s,25),w=l+y+ti(s,a,u)+Va[h]+ie[h]|0,p=(Ot(n,2)^Ot(n,13)^Ot(n,22))+ei(n,o,c)|0;l=u,u=a,a=s,s=i+w|0,i=c,c=o,o=n,n=w+p|0}n=n+this.A|0,o=o+this.B|0,c=c+this.C|0,i=i+this.D|0,s=s+this.E|0,a=a+this.F|0,u=u+this.G|0,l=l+this.H|0,this.set(n,o,c,i,s,a,u,l)}roundClean(){we(ie)}destroy(){this.set(0,0,0,0,0,0,0,0),we(this.buffer)}};var ri=Qs(()=>new fo);var cf=tn(mi());co.hmacSha256Sync=(e,...t)=>ao(ri,e,co.concatBytes(...t));var Gr=null,af=new Or,Ye=()=>{},lo=new Hr(100),ff=null;function wi(e,t){ff!==e&&lo.clear();let r=lo.get(t);return r||(r=kr.utils.getConversationKey(e,t),lo.set(t,r)),r}var Yr=440,Xr=420;bt.default.runtime.onInstalled.addListener((e,t,r)=>{r==="install"&&bt.default.runtime.openOptionsPage()});bt.default.runtime.onMessage.addListener(async(e,t)=>{if(e.openSignUp)lf(),bt.default.windows.remove(t.tab.windowId);else{let{prompt:r}=e;if(r)Ai(e,t);else return bi(e)}});bt.default.runtime.onMessageExternal.addListener(async({type:e,params:t},r)=>{let n=new URL(r.url).host;return bi({type:e,params:t,host:n})});bt.default.windows.onRemoved.addListener(e=>{Gr&&Ai({accept:!1},null)});async function bi({type:e,params:t,host:r}){if(Os[e]){switch(e){case"replaceURL":{let{protocol_handler:n}=await bt.default.storage.local.get(["protocol_handler"]);if(!n)return!1;let{url:o}=t,c=o.split("nostr:")[1],{type:i,data:s}=Qo(c),a={raw:c,hrp:i,hex:i==="npub"||i==="note"?s:i==="nprofile"?s.pubkey:i==="nevent"?s.id:null,p_or_e:{npub:"p",note:"e",nprofile:"p",nevent:"e"}[i],u_or_n:{npub:"u",note:"n",nprofile:"u",nevent:"n"}[i],relay0:i==="nprofile"?s.relays[0]:null,relay1:i==="nprofile"?s.relays[1]:null,relay2:i==="nprofile"?s.relays[2]:null},u=n;return Object.entries(a).forEach(([l,h])=>{u=u.replace(new RegExp(`{ *${l} *}`,"g"),h)}),u}}return}else{Ye=await af.acquire();let n=await uf(e,t),o=await Hs(r,e,e==="signEvent"?t.event:void 0);if(o===!0)Ye(),Jn(r,o,e,t);else{if(o===!1)return Ye(),Jn(r,o,e,t),{error:{message:"denied"}};try{let c=Math.random().toString().slice(4),i=new URLSearchParams({host:r,id:c,params:JSON.stringify(t),type:e});typeof n=="string"&&i.set("result",n);let{top:s,left:a}=await Qn(Yr,Xr);if(!await new Promise((l,h)=>{Gr={resolve:l,reject:h},bt.default.windows.create({url:`${bt.default.runtime.getURL("prompt.html")}?${i.toString()}`,type:"popup",width:Yr,height:Xr,top:s,left:a})}))return{error:{message:"denied"}}}catch(c){return Ye(),{error:{message:c.message,stack:c.stack}}}}return n}}async function uf(e,t){let r=await bt.default.storage.local.get("private_key");if(!r||!r.private_key)return{error:{message:"no private key found"}};let n=r.private_key;try{switch(e){case"getPublicKey":return zo(n);case"signEvent":{let o=Ko(t.event,n);return Tn(o)?o:{error:{message:"invalid event"}}}case"nip04.encrypt":{let{peer:o,plaintext:c}=t;return hs(n,o,c)}case"nip04.decrypt":{let{peer:o,ciphertext:c}=t;return ds(n,o,c)}case"nip44.encrypt":{let{peer:o,plaintext:c}=t,i=wi(n,o);return kr.encrypt(c,i)}case"nip44.decrypt":{let{peer:o,ciphertext:c}=t,i=wi(n,o);return kr.decrypt(c,i)}}}catch(o){return{error:{message:o.message,stack:o.stack}}}}async function Ai({host:e,type:t,accept:r,conditions:n},o){Gr?.resolve?.(r),n&&await Ns(e,t,r,n),Gr=null,Ye(),o&&bt.default.windows.remove(o.tab.windowId)}async function lf(){let{top:e,left:t}=await Qn(Yr,Xr);bt.default.windows.create({url:`${bt.default.runtime.getURL("signup.html")}`,type:"popup",width:Yr,height:Xr,top:e,left:t})}
/*! Bundled license information:

cashaddrjs/src/validation.js:
cashaddrjs/src/base32.js:
cashaddrjs/src/cashaddr.js:
  (**
   * @license
   * https://github.com/ealmansi/cashaddrjs
   * Copyright (c) 2017-2020 Emilio Almansi
   * Distributed under the MIT software license, see the accompanying
   * file LICENSE or http://www.opensource.org/licenses/mit-license.php.
   *)

@noble/hashes/esm/utils.js:
@noble/hashes/esm/utils.js:
@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
@noble/curves/esm/abstract/modular.js:
@noble/curves/esm/abstract/curve.js:
@noble/curves/esm/abstract/weierstrass.js:
@noble/curves/esm/_shortw_utils.js:
@noble/curves/esm/secp256k1.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@scure/base/lib/esm/index.js:
  (*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/ciphers/esm/utils.js:
  (*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) *)

@noble/secp256k1/index.js:
  (*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) *)
*/
